{
  "version": 3,
  "file": "token-editor.js",
  "sources": [
    "../lib/bullseye.js",
    "auto-complete.js",
    "token-editor.js"
  ],
  "names": [],
  "mappings": "AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,AC9/BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,ACnMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA",
  "sourcesContent": [
    "!function(e){if(\"object\"==typeof exports&&\"undefined\"!=typeof module)module.exports=e();else if(\"function\"==typeof define&&define.amd)define('../lib/bullseye',[],e);else{var f;\"undefined\"!=typeof window?f=window:\"undefined\"!=typeof global?f=global:\"undefined\"!=typeof self&&(f=self),f.bullseye=e()}}(function(){var define,module,exports;return (function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){\n'use strict';\n\nvar crossvent = require('crossvent');\nvar throttle = require('./throttle');\nvar tailormade = require('./tailormade');\n\nfunction bullseye (el, target, options) {\n  var o = options;\n  var domTarget = target && target.tagName;\n\n  if (!domTarget && arguments.length === 2) {\n    o = target;\n  }\n  if (!domTarget) {\n    target = el;\n  }\n  if (!o) { o = {}; }\n\n  var destroyed = false;\n  var throttledWrite = throttle(write, 30);\n  var tailorOptions = { update: o.autoupdateToCaret !== false && update };\n  var tailor = o.caret && tailormade(target, tailorOptions);\n\n  write();\n\n  if (o.tracking !== false) {\n    crossvent.add(window, 'resize', throttledWrite);\n  }\n\n  return {\n    read: readNull,\n    refresh: write,\n    destroy: destroy,\n    sleep: sleep\n  };\n\n  function sleep () {\n    tailorOptions.sleeping = true;\n  }\n\n  function readNull () { return read(); }\n\n  function read (readings) {\n    var bounds = target.getBoundingClientRect();\n    var scrollTop = document.body.scrollTop || document.documentElement.scrollTop;\n    if (tailor) {\n      readings = tailor.read();\n      return {\n        x: (readings.absolute ? 0 : bounds.left) + readings.x,\n        y: (readings.absolute ? 0 : bounds.top) + scrollTop + readings.y + 20\n      };\n    }\n    return {\n      x: bounds.left,\n      y: bounds.top + scrollTop\n    };\n  }\n\n  function update (readings) {\n    write(readings);\n  }\n\n  function write (readings) {\n    if (destroyed) {\n      throw new Error('Bullseye can\\'t refresh after being destroyed. Create another instance instead.');\n    }\n    if (tailor && !readings) {\n      tailorOptions.sleeping = false;\n      tailor.refresh(); return;\n    }\n    var p = read(readings);\n    if (!tailor && target !== el) {\n      p.y += target.offsetHeight;\n    }\n    el.style.left = p.x + 'px';\n    el.style.top = p.y + 'px';\n  }\n\n  function destroy () {\n    if (tailor) { tailor.destroy(); }\n    crossvent.remove(window, 'resize', throttledWrite);\n    destroyed = true;\n  }\n}\n\nmodule.exports = bullseye;\n\n},{\"./tailormade\":14,\"./throttle\":15,\"crossvent\":3}],2:[function(require,module,exports){\n(function (global){\n\nvar NativeCustomEvent = global.CustomEvent;\n\nfunction useNative () {\n  try {\n    var p = new NativeCustomEvent('cat', { detail: { foo: 'bar' } });\n    return  'cat' === p.type && 'bar' === p.detail.foo;\n  } catch (e) {\n  }\n  return false;\n}\n\n/**\n * Cross-browser `CustomEvent` constructor.\n *\n * https://developer.mozilla.org/en-US/docs/Web/API/CustomEvent.CustomEvent\n *\n * @public\n */\n\nmodule.exports = useNative() ? NativeCustomEvent :\n\n// IE >= 9\n'function' === typeof document.createEvent ? function CustomEvent (type, params) {\n  var e = document.createEvent('CustomEvent');\n  if (params) {\n    e.initCustomEvent(type, params.bubbles, params.cancelable, params.detail);\n  } else {\n    e.initCustomEvent(type, false, false, void 0);\n  }\n  return e;\n} :\n\n// IE <= 8\nfunction CustomEvent (type, params) {\n  var e = document.createEventObject();\n  e.type = type;\n  if (params) {\n    e.bubbles = Boolean(params.bubbles);\n    e.cancelable = Boolean(params.cancelable);\n    e.detail = params.detail;\n  } else {\n    e.bubbles = false;\n    e.cancelable = false;\n    e.detail = void 0;\n  }\n  return e;\n}\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9jcm9zc3ZlbnQvbm9kZV9tb2R1bGVzL2N1c3RvbS1ldmVudC9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIlxudmFyIE5hdGl2ZUN1c3RvbUV2ZW50ID0gZ2xvYmFsLkN1c3RvbUV2ZW50O1xuXG5mdW5jdGlvbiB1c2VOYXRpdmUgKCkge1xuICB0cnkge1xuICAgIHZhciBwID0gbmV3IE5hdGl2ZUN1c3RvbUV2ZW50KCdjYXQnLCB7IGRldGFpbDogeyBmb286ICdiYXInIH0gfSk7XG4gICAgcmV0dXJuICAnY2F0JyA9PT0gcC50eXBlICYmICdiYXInID09PSBwLmRldGFpbC5mb287XG4gIH0gY2F0Y2ggKGUpIHtcbiAgfVxuICByZXR1cm4gZmFsc2U7XG59XG5cbi8qKlxuICogQ3Jvc3MtYnJvd3NlciBgQ3VzdG9tRXZlbnRgIGNvbnN0cnVjdG9yLlxuICpcbiAqIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DdXN0b21FdmVudC5DdXN0b21FdmVudFxuICpcbiAqIEBwdWJsaWNcbiAqL1xuXG5tb2R1bGUuZXhwb3J0cyA9IHVzZU5hdGl2ZSgpID8gTmF0aXZlQ3VzdG9tRXZlbnQgOlxuXG4vLyBJRSA+PSA5XG4nZnVuY3Rpb24nID09PSB0eXBlb2YgZG9jdW1lbnQuY3JlYXRlRXZlbnQgPyBmdW5jdGlvbiBDdXN0b21FdmVudCAodHlwZSwgcGFyYW1zKSB7XG4gIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnQoJ0N1c3RvbUV2ZW50Jyk7XG4gIGlmIChwYXJhbXMpIHtcbiAgICBlLmluaXRDdXN0b21FdmVudCh0eXBlLCBwYXJhbXMuYnViYmxlcywgcGFyYW1zLmNhbmNlbGFibGUsIHBhcmFtcy5kZXRhaWwpO1xuICB9IGVsc2Uge1xuICAgIGUuaW5pdEN1c3RvbUV2ZW50KHR5cGUsIGZhbHNlLCBmYWxzZSwgdm9pZCAwKTtcbiAgfVxuICByZXR1cm4gZTtcbn0gOlxuXG4vLyBJRSA8PSA4XG5mdW5jdGlvbiBDdXN0b21FdmVudCAodHlwZSwgcGFyYW1zKSB7XG4gIHZhciBlID0gZG9jdW1lbnQuY3JlYXRlRXZlbnRPYmplY3QoKTtcbiAgZS50eXBlID0gdHlwZTtcbiAgaWYgKHBhcmFtcykge1xuICAgIGUuYnViYmxlcyA9IEJvb2xlYW4ocGFyYW1zLmJ1YmJsZXMpO1xuICAgIGUuY2FuY2VsYWJsZSA9IEJvb2xlYW4ocGFyYW1zLmNhbmNlbGFibGUpO1xuICAgIGUuZGV0YWlsID0gcGFyYW1zLmRldGFpbDtcbiAgfSBlbHNlIHtcbiAgICBlLmJ1YmJsZXMgPSBmYWxzZTtcbiAgICBlLmNhbmNlbGFibGUgPSBmYWxzZTtcbiAgICBlLmRldGFpbCA9IHZvaWQgMDtcbiAgfVxuICByZXR1cm4gZTtcbn1cbiJdfQ==\n},{}],3:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar customEvent = require('custom-event');\nvar eventmap = require('./eventmap');\nvar doc = document;\nvar addEvent = addEventEasy;\nvar removeEvent = removeEventEasy;\nvar hardCache = [];\n\nif (!global.addEventListener) {\n  addEvent = addEventHard;\n  removeEvent = removeEventHard;\n}\n\nfunction addEventEasy (el, type, fn, capturing) {\n  return el.addEventListener(type, fn, capturing);\n}\n\nfunction addEventHard (el, type, fn) {\n  return el.attachEvent('on' + type, wrap(el, type, fn));\n}\n\nfunction removeEventEasy (el, type, fn, capturing) {\n  return el.removeEventListener(type, fn, capturing);\n}\n\nfunction removeEventHard (el, type, fn) {\n  return el.detachEvent('on' + type, unwrap(el, type, fn));\n}\n\nfunction fabricateEvent (el, type, model) {\n  var e = eventmap.indexOf(type) === -1 ? makeCustomEvent() : makeClassicEvent();\n  if (el.dispatchEvent) {\n    el.dispatchEvent(e);\n  } else {\n    el.fireEvent('on' + type, e);\n  }\n  function makeClassicEvent () {\n    var e;\n    if (doc.createEvent) {\n      e = doc.createEvent('Event');\n      e.initEvent(type, true, true);\n    } else if (doc.createEventObject) {\n      e = doc.createEventObject();\n    }\n    return e;\n  }\n  function makeCustomEvent () {\n    return new customEvent(type, { detail: model });\n  }\n}\n\nfunction wrapperFactory (el, type, fn) {\n  return function wrapper (originalEvent) {\n    var e = originalEvent || global.event;\n    e.target = e.target || e.srcElement;\n    e.preventDefault = e.preventDefault || function preventDefault () { e.returnValue = false; };\n    e.stopPropagation = e.stopPropagation || function stopPropagation () { e.cancelBubble = true; };\n    e.which = e.which || e.keyCode;\n    fn.call(el, e);\n  };\n}\n\nfunction wrap (el, type, fn) {\n  var wrapper = unwrap(el, type, fn) || wrapperFactory(el, type, fn);\n  hardCache.push({\n    wrapper: wrapper,\n    element: el,\n    type: type,\n    fn: fn\n  });\n  return wrapper;\n}\n\nfunction unwrap (el, type, fn) {\n  var i = find(el, type, fn);\n  if (i) {\n    var wrapper = hardCache[i].wrapper;\n    hardCache.splice(i, 1); // free up a tad of memory\n    return wrapper;\n  }\n}\n\nfunction find (el, type, fn) {\n  var i, item;\n  for (i = 0; i < hardCache.length; i++) {\n    item = hardCache[i];\n    if (item.element === el && item.type === type && item.fn === fn) {\n      return i;\n    }\n  }\n}\n\nmodule.exports = {\n  add: addEvent,\n  remove: removeEvent,\n  fabricate: fabricateEvent\n};\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9jcm9zc3ZlbnQvc3JjL2Nyb3NzdmVudC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBjdXN0b21FdmVudCA9IHJlcXVpcmUoJ2N1c3RvbS1ldmVudCcpO1xudmFyIGV2ZW50bWFwID0gcmVxdWlyZSgnLi9ldmVudG1hcCcpO1xudmFyIGRvYyA9IGRvY3VtZW50O1xudmFyIGFkZEV2ZW50ID0gYWRkRXZlbnRFYXN5O1xudmFyIHJlbW92ZUV2ZW50ID0gcmVtb3ZlRXZlbnRFYXN5O1xudmFyIGhhcmRDYWNoZSA9IFtdO1xuXG5pZiAoIWdsb2JhbC5hZGRFdmVudExpc3RlbmVyKSB7XG4gIGFkZEV2ZW50ID0gYWRkRXZlbnRIYXJkO1xuICByZW1vdmVFdmVudCA9IHJlbW92ZUV2ZW50SGFyZDtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnRFYXN5IChlbCwgdHlwZSwgZm4sIGNhcHR1cmluZykge1xuICByZXR1cm4gZWwuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgY2FwdHVyaW5nKTtcbn1cblxuZnVuY3Rpb24gYWRkRXZlbnRIYXJkIChlbCwgdHlwZSwgZm4pIHtcbiAgcmV0dXJuIGVsLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCB3cmFwKGVsLCB0eXBlLCBmbikpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVFdmVudEVhc3kgKGVsLCB0eXBlLCBmbiwgY2FwdHVyaW5nKSB7XG4gIHJldHVybiBlbC5yZW1vdmVFdmVudExpc3RlbmVyKHR5cGUsIGZuLCBjYXB0dXJpbmcpO1xufVxuXG5mdW5jdGlvbiByZW1vdmVFdmVudEhhcmQgKGVsLCB0eXBlLCBmbikge1xuICByZXR1cm4gZWwuZGV0YWNoRXZlbnQoJ29uJyArIHR5cGUsIHVud3JhcChlbCwgdHlwZSwgZm4pKTtcbn1cblxuZnVuY3Rpb24gZmFicmljYXRlRXZlbnQgKGVsLCB0eXBlLCBtb2RlbCkge1xuICB2YXIgZSA9IGV2ZW50bWFwLmluZGV4T2YodHlwZSkgPT09IC0xID8gbWFrZUN1c3RvbUV2ZW50KCkgOiBtYWtlQ2xhc3NpY0V2ZW50KCk7XG4gIGlmIChlbC5kaXNwYXRjaEV2ZW50KSB7XG4gICAgZWwuZGlzcGF0Y2hFdmVudChlKTtcbiAgfSBlbHNlIHtcbiAgICBlbC5maXJlRXZlbnQoJ29uJyArIHR5cGUsIGUpO1xuICB9XG4gIGZ1bmN0aW9uIG1ha2VDbGFzc2ljRXZlbnQgKCkge1xuICAgIHZhciBlO1xuICAgIGlmIChkb2MuY3JlYXRlRXZlbnQpIHtcbiAgICAgIGUgPSBkb2MuY3JlYXRlRXZlbnQoJ0V2ZW50Jyk7XG4gICAgICBlLmluaXRFdmVudCh0eXBlLCB0cnVlLCB0cnVlKTtcbiAgICB9IGVsc2UgaWYgKGRvYy5jcmVhdGVFdmVudE9iamVjdCkge1xuICAgICAgZSA9IGRvYy5jcmVhdGVFdmVudE9iamVjdCgpO1xuICAgIH1cbiAgICByZXR1cm4gZTtcbiAgfVxuICBmdW5jdGlvbiBtYWtlQ3VzdG9tRXZlbnQgKCkge1xuICAgIHJldHVybiBuZXcgY3VzdG9tRXZlbnQodHlwZSwgeyBkZXRhaWw6IG1vZGVsIH0pO1xuICB9XG59XG5cbmZ1bmN0aW9uIHdyYXBwZXJGYWN0b3J5IChlbCwgdHlwZSwgZm4pIHtcbiAgcmV0dXJuIGZ1bmN0aW9uIHdyYXBwZXIgKG9yaWdpbmFsRXZlbnQpIHtcbiAgICB2YXIgZSA9IG9yaWdpbmFsRXZlbnQgfHwgZ2xvYmFsLmV2ZW50O1xuICAgIGUudGFyZ2V0ID0gZS50YXJnZXQgfHwgZS5zcmNFbGVtZW50O1xuICAgIGUucHJldmVudERlZmF1bHQgPSBlLnByZXZlbnREZWZhdWx0IHx8IGZ1bmN0aW9uIHByZXZlbnREZWZhdWx0ICgpIHsgZS5yZXR1cm5WYWx1ZSA9IGZhbHNlOyB9O1xuICAgIGUuc3RvcFByb3BhZ2F0aW9uID0gZS5zdG9wUHJvcGFnYXRpb24gfHwgZnVuY3Rpb24gc3RvcFByb3BhZ2F0aW9uICgpIHsgZS5jYW5jZWxCdWJibGUgPSB0cnVlOyB9O1xuICAgIGUud2hpY2ggPSBlLndoaWNoIHx8IGUua2V5Q29kZTtcbiAgICBmbi5jYWxsKGVsLCBlKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gd3JhcCAoZWwsIHR5cGUsIGZuKSB7XG4gIHZhciB3cmFwcGVyID0gdW53cmFwKGVsLCB0eXBlLCBmbikgfHwgd3JhcHBlckZhY3RvcnkoZWwsIHR5cGUsIGZuKTtcbiAgaGFyZENhY2hlLnB1c2goe1xuICAgIHdyYXBwZXI6IHdyYXBwZXIsXG4gICAgZWxlbWVudDogZWwsXG4gICAgdHlwZTogdHlwZSxcbiAgICBmbjogZm5cbiAgfSk7XG4gIHJldHVybiB3cmFwcGVyO1xufVxuXG5mdW5jdGlvbiB1bndyYXAgKGVsLCB0eXBlLCBmbikge1xuICB2YXIgaSA9IGZpbmQoZWwsIHR5cGUsIGZuKTtcbiAgaWYgKGkpIHtcbiAgICB2YXIgd3JhcHBlciA9IGhhcmRDYWNoZVtpXS53cmFwcGVyO1xuICAgIGhhcmRDYWNoZS5zcGxpY2UoaSwgMSk7IC8vIGZyZWUgdXAgYSB0YWQgb2YgbWVtb3J5XG4gICAgcmV0dXJuIHdyYXBwZXI7XG4gIH1cbn1cblxuZnVuY3Rpb24gZmluZCAoZWwsIHR5cGUsIGZuKSB7XG4gIHZhciBpLCBpdGVtO1xuICBmb3IgKGkgPSAwOyBpIDwgaGFyZENhY2hlLmxlbmd0aDsgaSsrKSB7XG4gICAgaXRlbSA9IGhhcmRDYWNoZVtpXTtcbiAgICBpZiAoaXRlbS5lbGVtZW50ID09PSBlbCAmJiBpdGVtLnR5cGUgPT09IHR5cGUgJiYgaXRlbS5mbiA9PT0gZm4pIHtcbiAgICAgIHJldHVybiBpO1xuICAgIH1cbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHtcbiAgYWRkOiBhZGRFdmVudCxcbiAgcmVtb3ZlOiByZW1vdmVFdmVudCxcbiAgZmFicmljYXRlOiBmYWJyaWNhdGVFdmVudFxufTtcbiJdfQ==\n},{\"./eventmap\":4,\"custom-event\":2}],4:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar eventmap = [];\nvar eventname = '';\nvar ron = /^on/;\n\nfor (eventname in global) {\n  if (ron.test(eventname)) {\n    eventmap.push(eventname.slice(2));\n  }\n}\n\nmodule.exports = eventmap;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9jcm9zc3ZlbnQvc3JjL2V2ZW50bWFwLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBldmVudG1hcCA9IFtdO1xudmFyIGV2ZW50bmFtZSA9ICcnO1xudmFyIHJvbiA9IC9eb24vO1xuXG5mb3IgKGV2ZW50bmFtZSBpbiBnbG9iYWwpIHtcbiAgaWYgKHJvbi50ZXN0KGV2ZW50bmFtZSkpIHtcbiAgICBldmVudG1hcC5wdXNoKGV2ZW50bmFtZS5zbGljZSgyKSk7XG4gIH1cbn1cblxubW9kdWxlLmV4cG9ydHMgPSBldmVudG1hcDtcbiJdfQ==\n},{}],5:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar getSelection;\nvar doc = global.document;\nvar getSelectionRaw = require('./getSelectionRaw');\nvar getSelectionNullOp = require('./getSelectionNullOp');\nvar getSelectionSynthetic = require('./getSelectionSynthetic');\nvar isHost = require('./isHost');\nif (isHost.method(global, 'getSelection')) {\n  getSelection = getSelectionRaw;\n} else if (typeof doc.selection === 'object' && doc.selection) {\n  getSelection = getSelectionSynthetic;\n} else {\n  getSelection = getSelectionNullOp;\n}\n\nmodule.exports = getSelection;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9zZWxlY2Npb24vc3JjL2dldFNlbGVjdGlvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBnZXRTZWxlY3Rpb247XG52YXIgZG9jID0gZ2xvYmFsLmRvY3VtZW50O1xudmFyIGdldFNlbGVjdGlvblJhdyA9IHJlcXVpcmUoJy4vZ2V0U2VsZWN0aW9uUmF3Jyk7XG52YXIgZ2V0U2VsZWN0aW9uTnVsbE9wID0gcmVxdWlyZSgnLi9nZXRTZWxlY3Rpb25OdWxsT3AnKTtcbnZhciBnZXRTZWxlY3Rpb25TeW50aGV0aWMgPSByZXF1aXJlKCcuL2dldFNlbGVjdGlvblN5bnRoZXRpYycpO1xudmFyIGlzSG9zdCA9IHJlcXVpcmUoJy4vaXNIb3N0Jyk7XG5pZiAoaXNIb3N0Lm1ldGhvZChnbG9iYWwsICdnZXRTZWxlY3Rpb24nKSkge1xuICBnZXRTZWxlY3Rpb24gPSBnZXRTZWxlY3Rpb25SYXc7XG59IGVsc2UgaWYgKHR5cGVvZiBkb2Muc2VsZWN0aW9uID09PSAnb2JqZWN0JyAmJiBkb2Muc2VsZWN0aW9uKSB7XG4gIGdldFNlbGVjdGlvbiA9IGdldFNlbGVjdGlvblN5bnRoZXRpYztcbn0gZWxzZSB7XG4gIGdldFNlbGVjdGlvbiA9IGdldFNlbGVjdGlvbk51bGxPcDtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBnZXRTZWxlY3Rpb247XG4iXX0=\n},{\"./getSelectionNullOp\":6,\"./getSelectionRaw\":7,\"./getSelectionSynthetic\":8,\"./isHost\":9}],6:[function(require,module,exports){\n'use strict';\n\nfunction noop () {}\n\nfunction getSelectionNullOp () {\n  return {\n    removeAllRanges: noop,\n    addRange: noop\n  };\n}\n\nmodule.exports = getSelectionNullOp;\n\n},{}],7:[function(require,module,exports){\n(function (global){\n'use strict';\n\nfunction getSelectionRaw () {\n  return global.getSelection();\n}\n\nmodule.exports = getSelectionRaw;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9zZWxlY2Npb24vc3JjL2dldFNlbGVjdGlvblJhdy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG5mdW5jdGlvbiBnZXRTZWxlY3Rpb25SYXcgKCkge1xuICByZXR1cm4gZ2xvYmFsLmdldFNlbGVjdGlvbigpO1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IGdldFNlbGVjdGlvblJhdztcbiJdfQ==\n},{}],8:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar rangeToTextRange = require('./rangeToTextRange');\nvar doc = global.document;\nvar body = doc.body;\nvar GetSelectionProto = GetSelection.prototype;\n\nfunction GetSelection (selection) {\n  var self = this;\n  var range = selection.createRange();\n\n  this._selection = selection;\n  this._ranges = [];\n\n  if (selection.type === 'Control') {\n    updateControlSelection(self);\n  } else if (isTextRange(range)) {\n    updateFromTextRange(self, range);\n  } else {\n    updateEmptySelection(self);\n  }\n}\n\nGetSelectionProto.removeAllRanges = function () {\n  var textRange;\n  try {\n    this._selection.empty();\n    if (this._selection.type !== 'None') {\n      textRange = body.createTextRange();\n      textRange.select();\n      this._selection.empty();\n    }\n  } catch (e) {\n  }\n  updateEmptySelection(this);\n};\n\nGetSelectionProto.addRange = function (range) {\n  if (this._selection.type === 'Control') {\n    addRangeToControlSelection(this, range);\n  } else {\n    rangeToTextRange(range).select();\n    this._ranges[0] = range;\n    this.rangeCount = 1;\n    this.isCollapsed = this._ranges[0].collapsed;\n    updateAnchorAndFocusFromRange(this, range, false);\n  }\n};\n\nGetSelectionProto.setRanges = function (ranges) {\n  this.removeAllRanges();\n  var rangeCount = ranges.length;\n  if (rangeCount > 1) {\n    createControlSelection(this, ranges);\n  } else if (rangeCount) {\n    this.addRange(ranges[0]);\n  }\n};\n\nGetSelectionProto.getRangeAt = function (index) {\n  if (index < 0 || index >= this.rangeCount) {\n    throw new Error('getRangeAt(): index out of bounds');\n  } else {\n    return this._ranges[index].cloneRange();\n  }\n};\n\nGetSelectionProto.removeRange = function (range) {\n  if (this._selection.type !== 'Control') {\n    removeRangeManually(this, range);\n    return;\n  }\n  var controlRange = this._selection.createRange();\n  var rangeElement = getSingleElementFromRange(range);\n  var newControlRange = body.createControlRange();\n  var el;\n  var removed = false;\n  for (var i = 0, len = controlRange.length; i < len; ++i) {\n    el = controlRange.item(i);\n    if (el !== rangeElement || removed) {\n      newControlRange.add(controlRange.item(i));\n    } else {\n      removed = true;\n    }\n  }\n  newControlRange.select();\n  updateControlSelection(this);\n};\n\nGetSelectionProto.eachRange = function (fn, returnValue) {\n  var i = 0;\n  var len = this._ranges.length;\n  for (i = 0; i < len; ++i) {\n    if (fn(this.getRangeAt(i))) {\n      return returnValue;\n    }\n  }\n};\n\nGetSelectionProto.getAllRanges = function () {\n  var ranges = [];\n  this.eachRange(function (range) {\n    ranges.push(range);\n  });\n  return ranges;\n};\n\nGetSelectionProto.setSingleRange = function (range) {\n  this.removeAllRanges();\n  this.addRange(range);\n};\n\nfunction createControlSelection (sel, ranges) {\n  var controlRange = body.createControlRange();\n  for (var i = 0, el, len = ranges.length; i < len; ++i) {\n    el = getSingleElementFromRange(ranges[i]);\n    try {\n      controlRange.add(el);\n    } catch (e) {\n      throw new Error('setRanges(): Element could not be added to control selection');\n    }\n  }\n  controlRange.select();\n  updateControlSelection(sel);\n}\n\nfunction removeRangeManually (sel, range) {\n  var ranges = sel.getAllRanges();\n  sel.removeAllRanges();\n  for (var i = 0, len = ranges.length; i < len; ++i) {\n    if (!isSameRange(range, ranges[i])) {\n      sel.addRange(ranges[i]);\n    }\n  }\n  if (!sel.rangeCount) {\n    updateEmptySelection(sel);\n  }\n}\n\nfunction updateAnchorAndFocusFromRange (sel, range) {\n  var anchorPrefix = 'start';\n  var focusPrefix = 'end';\n  sel.anchorNode = range[anchorPrefix + 'Container'];\n  sel.anchorOffset = range[anchorPrefix + 'Offset'];\n  sel.focusNode = range[focusPrefix + 'Container'];\n  sel.focusOffset = range[focusPrefix + 'Offset'];\n}\n\nfunction updateEmptySelection (sel) {\n  sel.anchorNode = sel.focusNode = null;\n  sel.anchorOffset = sel.focusOffset = 0;\n  sel.rangeCount = 0;\n  sel.isCollapsed = true;\n  sel._ranges.length = 0;\n}\n\nfunction rangeContainsSingleElement (rangeNodes) {\n  if (!rangeNodes.length || rangeNodes[0].nodeType !== 1) {\n    return false;\n  }\n  for (var i = 1, len = rangeNodes.length; i < len; ++i) {\n    if (!isAncestorOf(rangeNodes[0], rangeNodes[i])) {\n      return false;\n    }\n  }\n  return true;\n}\n\nfunction getSingleElementFromRange (range) {\n  var nodes = range.getNodes();\n  if (!rangeContainsSingleElement(nodes)) {\n    throw new Error('getSingleElementFromRange(): range did not consist of a single element');\n  }\n  return nodes[0];\n}\n\nfunction isTextRange (range) {\n  return range && range.text !== void 0;\n}\n\nfunction updateFromTextRange (sel, range) {\n  sel._ranges = [range];\n  updateAnchorAndFocusFromRange(sel, range, false);\n  sel.rangeCount = 1;\n  sel.isCollapsed = range.collapsed;\n}\n\nfunction updateControlSelection (sel) {\n  sel._ranges.length = 0;\n  if (sel._selection.type === 'None') {\n    updateEmptySelection(sel);\n  } else {\n    var controlRange = sel._selection.createRange();\n    if (isTextRange(controlRange)) {\n      updateFromTextRange(sel, controlRange);\n    } else {\n      sel.rangeCount = controlRange.length;\n      var range;\n      for (var i = 0; i < sel.rangeCount; ++i) {\n        range = doc.createRange();\n        range.selectNode(controlRange.item(i));\n        sel._ranges.push(range);\n      }\n      sel.isCollapsed = sel.rangeCount === 1 && sel._ranges[0].collapsed;\n      updateAnchorAndFocusFromRange(sel, sel._ranges[sel.rangeCount - 1], false);\n    }\n  }\n}\n\nfunction addRangeToControlSelection (sel, range) {\n  var controlRange = sel._selection.createRange();\n  var rangeElement = getSingleElementFromRange(range);\n  var newControlRange = body.createControlRange();\n  for (var i = 0, len = controlRange.length; i < len; ++i) {\n    newControlRange.add(controlRange.item(i));\n  }\n  try {\n    newControlRange.add(rangeElement);\n  } catch (e) {\n    throw new Error('addRange(): Element could not be added to control selection');\n  }\n  newControlRange.select();\n  updateControlSelection(sel);\n}\n\nfunction isSameRange (left, right) {\n  return (\n    left.startContainer === right.startContainer &&\n    left.startOffset === right.startOffset &&\n    left.endContainer === right.endContainer &&\n    left.endOffset === right.endOffset\n  );\n}\n\nfunction isAncestorOf (ancestor, descendant) {\n  var node = descendant;\n  while (node.parentNode) {\n    if (node.parentNode === ancestor) {\n      return true;\n    }\n    node = node.parentNode;\n  }\n  return false;\n}\n\nfunction getSelection () {\n  return new GetSelection(global.document.selection);\n}\n\nmodule.exports = getSelection;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9zZWxlY2Npb24vc3JjL2dldFNlbGVjdGlvblN5bnRoZXRpYy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgcmFuZ2VUb1RleHRSYW5nZSA9IHJlcXVpcmUoJy4vcmFuZ2VUb1RleHRSYW5nZScpO1xudmFyIGRvYyA9IGdsb2JhbC5kb2N1bWVudDtcbnZhciBib2R5ID0gZG9jLmJvZHk7XG52YXIgR2V0U2VsZWN0aW9uUHJvdG8gPSBHZXRTZWxlY3Rpb24ucHJvdG90eXBlO1xuXG5mdW5jdGlvbiBHZXRTZWxlY3Rpb24gKHNlbGVjdGlvbikge1xuICB2YXIgc2VsZiA9IHRoaXM7XG4gIHZhciByYW5nZSA9IHNlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuXG4gIHRoaXMuX3NlbGVjdGlvbiA9IHNlbGVjdGlvbjtcbiAgdGhpcy5fcmFuZ2VzID0gW107XG5cbiAgaWYgKHNlbGVjdGlvbi50eXBlID09PSAnQ29udHJvbCcpIHtcbiAgICB1cGRhdGVDb250cm9sU2VsZWN0aW9uKHNlbGYpO1xuICB9IGVsc2UgaWYgKGlzVGV4dFJhbmdlKHJhbmdlKSkge1xuICAgIHVwZGF0ZUZyb21UZXh0UmFuZ2Uoc2VsZiwgcmFuZ2UpO1xuICB9IGVsc2Uge1xuICAgIHVwZGF0ZUVtcHR5U2VsZWN0aW9uKHNlbGYpO1xuICB9XG59XG5cbkdldFNlbGVjdGlvblByb3RvLnJlbW92ZUFsbFJhbmdlcyA9IGZ1bmN0aW9uICgpIHtcbiAgdmFyIHRleHRSYW5nZTtcbiAgdHJ5IHtcbiAgICB0aGlzLl9zZWxlY3Rpb24uZW1wdHkoKTtcbiAgICBpZiAodGhpcy5fc2VsZWN0aW9uLnR5cGUgIT09ICdOb25lJykge1xuICAgICAgdGV4dFJhbmdlID0gYm9keS5jcmVhdGVUZXh0UmFuZ2UoKTtcbiAgICAgIHRleHRSYW5nZS5zZWxlY3QoKTtcbiAgICAgIHRoaXMuX3NlbGVjdGlvbi5lbXB0eSgpO1xuICAgIH1cbiAgfSBjYXRjaCAoZSkge1xuICB9XG4gIHVwZGF0ZUVtcHR5U2VsZWN0aW9uKHRoaXMpO1xufTtcblxuR2V0U2VsZWN0aW9uUHJvdG8uYWRkUmFuZ2UgPSBmdW5jdGlvbiAocmFuZ2UpIHtcbiAgaWYgKHRoaXMuX3NlbGVjdGlvbi50eXBlID09PSAnQ29udHJvbCcpIHtcbiAgICBhZGRSYW5nZVRvQ29udHJvbFNlbGVjdGlvbih0aGlzLCByYW5nZSk7XG4gIH0gZWxzZSB7XG4gICAgcmFuZ2VUb1RleHRSYW5nZShyYW5nZSkuc2VsZWN0KCk7XG4gICAgdGhpcy5fcmFuZ2VzWzBdID0gcmFuZ2U7XG4gICAgdGhpcy5yYW5nZUNvdW50ID0gMTtcbiAgICB0aGlzLmlzQ29sbGFwc2VkID0gdGhpcy5fcmFuZ2VzWzBdLmNvbGxhcHNlZDtcbiAgICB1cGRhdGVBbmNob3JBbmRGb2N1c0Zyb21SYW5nZSh0aGlzLCByYW5nZSwgZmFsc2UpO1xuICB9XG59O1xuXG5HZXRTZWxlY3Rpb25Qcm90by5zZXRSYW5nZXMgPSBmdW5jdGlvbiAocmFuZ2VzKSB7XG4gIHRoaXMucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIHZhciByYW5nZUNvdW50ID0gcmFuZ2VzLmxlbmd0aDtcbiAgaWYgKHJhbmdlQ291bnQgPiAxKSB7XG4gICAgY3JlYXRlQ29udHJvbFNlbGVjdGlvbih0aGlzLCByYW5nZXMpO1xuICB9IGVsc2UgaWYgKHJhbmdlQ291bnQpIHtcbiAgICB0aGlzLmFkZFJhbmdlKHJhbmdlc1swXSk7XG4gIH1cbn07XG5cbkdldFNlbGVjdGlvblByb3RvLmdldFJhbmdlQXQgPSBmdW5jdGlvbiAoaW5kZXgpIHtcbiAgaWYgKGluZGV4IDwgMCB8fCBpbmRleCA+PSB0aGlzLnJhbmdlQ291bnQpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2dldFJhbmdlQXQoKTogaW5kZXggb3V0IG9mIGJvdW5kcycpO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiB0aGlzLl9yYW5nZXNbaW5kZXhdLmNsb25lUmFuZ2UoKTtcbiAgfVxufTtcblxuR2V0U2VsZWN0aW9uUHJvdG8ucmVtb3ZlUmFuZ2UgPSBmdW5jdGlvbiAocmFuZ2UpIHtcbiAgaWYgKHRoaXMuX3NlbGVjdGlvbi50eXBlICE9PSAnQ29udHJvbCcpIHtcbiAgICByZW1vdmVSYW5nZU1hbnVhbGx5KHRoaXMsIHJhbmdlKTtcbiAgICByZXR1cm47XG4gIH1cbiAgdmFyIGNvbnRyb2xSYW5nZSA9IHRoaXMuX3NlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICB2YXIgcmFuZ2VFbGVtZW50ID0gZ2V0U2luZ2xlRWxlbWVudEZyb21SYW5nZShyYW5nZSk7XG4gIHZhciBuZXdDb250cm9sUmFuZ2UgPSBib2R5LmNyZWF0ZUNvbnRyb2xSYW5nZSgpO1xuICB2YXIgZWw7XG4gIHZhciByZW1vdmVkID0gZmFsc2U7XG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSBjb250cm9sUmFuZ2UubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICBlbCA9IGNvbnRyb2xSYW5nZS5pdGVtKGkpO1xuICAgIGlmIChlbCAhPT0gcmFuZ2VFbGVtZW50IHx8IHJlbW92ZWQpIHtcbiAgICAgIG5ld0NvbnRyb2xSYW5nZS5hZGQoY29udHJvbFJhbmdlLml0ZW0oaSkpO1xuICAgIH0gZWxzZSB7XG4gICAgICByZW1vdmVkID0gdHJ1ZTtcbiAgICB9XG4gIH1cbiAgbmV3Q29udHJvbFJhbmdlLnNlbGVjdCgpO1xuICB1cGRhdGVDb250cm9sU2VsZWN0aW9uKHRoaXMpO1xufTtcblxuR2V0U2VsZWN0aW9uUHJvdG8uZWFjaFJhbmdlID0gZnVuY3Rpb24gKGZuLCByZXR1cm5WYWx1ZSkge1xuICB2YXIgaSA9IDA7XG4gIHZhciBsZW4gPSB0aGlzLl9yYW5nZXMubGVuZ3RoO1xuICBmb3IgKGkgPSAwOyBpIDwgbGVuOyArK2kpIHtcbiAgICBpZiAoZm4odGhpcy5nZXRSYW5nZUF0KGkpKSkge1xuICAgICAgcmV0dXJuIHJldHVyblZhbHVlO1xuICAgIH1cbiAgfVxufTtcblxuR2V0U2VsZWN0aW9uUHJvdG8uZ2V0QWxsUmFuZ2VzID0gZnVuY3Rpb24gKCkge1xuICB2YXIgcmFuZ2VzID0gW107XG4gIHRoaXMuZWFjaFJhbmdlKGZ1bmN0aW9uIChyYW5nZSkge1xuICAgIHJhbmdlcy5wdXNoKHJhbmdlKTtcbiAgfSk7XG4gIHJldHVybiByYW5nZXM7XG59O1xuXG5HZXRTZWxlY3Rpb25Qcm90by5zZXRTaW5nbGVSYW5nZSA9IGZ1bmN0aW9uIChyYW5nZSkge1xuICB0aGlzLnJlbW92ZUFsbFJhbmdlcygpO1xuICB0aGlzLmFkZFJhbmdlKHJhbmdlKTtcbn07XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRyb2xTZWxlY3Rpb24gKHNlbCwgcmFuZ2VzKSB7XG4gIHZhciBjb250cm9sUmFuZ2UgPSBib2R5LmNyZWF0ZUNvbnRyb2xSYW5nZSgpO1xuICBmb3IgKHZhciBpID0gMCwgZWwsIGxlbiA9IHJhbmdlcy5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgIGVsID0gZ2V0U2luZ2xlRWxlbWVudEZyb21SYW5nZShyYW5nZXNbaV0pO1xuICAgIHRyeSB7XG4gICAgICBjb250cm9sUmFuZ2UuYWRkKGVsKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ3NldFJhbmdlcygpOiBFbGVtZW50IGNvdWxkIG5vdCBiZSBhZGRlZCB0byBjb250cm9sIHNlbGVjdGlvbicpO1xuICAgIH1cbiAgfVxuICBjb250cm9sUmFuZ2Uuc2VsZWN0KCk7XG4gIHVwZGF0ZUNvbnRyb2xTZWxlY3Rpb24oc2VsKTtcbn1cblxuZnVuY3Rpb24gcmVtb3ZlUmFuZ2VNYW51YWxseSAoc2VsLCByYW5nZSkge1xuICB2YXIgcmFuZ2VzID0gc2VsLmdldEFsbFJhbmdlcygpO1xuICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gIGZvciAodmFyIGkgPSAwLCBsZW4gPSByYW5nZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICBpZiAoIWlzU2FtZVJhbmdlKHJhbmdlLCByYW5nZXNbaV0pKSB7XG4gICAgICBzZWwuYWRkUmFuZ2UocmFuZ2VzW2ldKTtcbiAgICB9XG4gIH1cbiAgaWYgKCFzZWwucmFuZ2VDb3VudCkge1xuICAgIHVwZGF0ZUVtcHR5U2VsZWN0aW9uKHNlbCk7XG4gIH1cbn1cblxuZnVuY3Rpb24gdXBkYXRlQW5jaG9yQW5kRm9jdXNGcm9tUmFuZ2UgKHNlbCwgcmFuZ2UpIHtcbiAgdmFyIGFuY2hvclByZWZpeCA9ICdzdGFydCc7XG4gIHZhciBmb2N1c1ByZWZpeCA9ICdlbmQnO1xuICBzZWwuYW5jaG9yTm9kZSA9IHJhbmdlW2FuY2hvclByZWZpeCArICdDb250YWluZXInXTtcbiAgc2VsLmFuY2hvck9mZnNldCA9IHJhbmdlW2FuY2hvclByZWZpeCArICdPZmZzZXQnXTtcbiAgc2VsLmZvY3VzTm9kZSA9IHJhbmdlW2ZvY3VzUHJlZml4ICsgJ0NvbnRhaW5lciddO1xuICBzZWwuZm9jdXNPZmZzZXQgPSByYW5nZVtmb2N1c1ByZWZpeCArICdPZmZzZXQnXTtcbn1cblxuZnVuY3Rpb24gdXBkYXRlRW1wdHlTZWxlY3Rpb24gKHNlbCkge1xuICBzZWwuYW5jaG9yTm9kZSA9IHNlbC5mb2N1c05vZGUgPSBudWxsO1xuICBzZWwuYW5jaG9yT2Zmc2V0ID0gc2VsLmZvY3VzT2Zmc2V0ID0gMDtcbiAgc2VsLnJhbmdlQ291bnQgPSAwO1xuICBzZWwuaXNDb2xsYXBzZWQgPSB0cnVlO1xuICBzZWwuX3Jhbmdlcy5sZW5ndGggPSAwO1xufVxuXG5mdW5jdGlvbiByYW5nZUNvbnRhaW5zU2luZ2xlRWxlbWVudCAocmFuZ2VOb2Rlcykge1xuICBpZiAoIXJhbmdlTm9kZXMubGVuZ3RoIHx8IHJhbmdlTm9kZXNbMF0ubm9kZVR5cGUgIT09IDEpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZm9yICh2YXIgaSA9IDEsIGxlbiA9IHJhbmdlTm9kZXMubGVuZ3RoOyBpIDwgbGVuOyArK2kpIHtcbiAgICBpZiAoIWlzQW5jZXN0b3JPZihyYW5nZU5vZGVzWzBdLCByYW5nZU5vZGVzW2ldKSkge1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuICByZXR1cm4gdHJ1ZTtcbn1cblxuZnVuY3Rpb24gZ2V0U2luZ2xlRWxlbWVudEZyb21SYW5nZSAocmFuZ2UpIHtcbiAgdmFyIG5vZGVzID0gcmFuZ2UuZ2V0Tm9kZXMoKTtcbiAgaWYgKCFyYW5nZUNvbnRhaW5zU2luZ2xlRWxlbWVudChub2RlcykpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoJ2dldFNpbmdsZUVsZW1lbnRGcm9tUmFuZ2UoKTogcmFuZ2UgZGlkIG5vdCBjb25zaXN0IG9mIGEgc2luZ2xlIGVsZW1lbnQnKTtcbiAgfVxuICByZXR1cm4gbm9kZXNbMF07XG59XG5cbmZ1bmN0aW9uIGlzVGV4dFJhbmdlIChyYW5nZSkge1xuICByZXR1cm4gcmFuZ2UgJiYgcmFuZ2UudGV4dCAhPT0gdm9pZCAwO1xufVxuXG5mdW5jdGlvbiB1cGRhdGVGcm9tVGV4dFJhbmdlIChzZWwsIHJhbmdlKSB7XG4gIHNlbC5fcmFuZ2VzID0gW3JhbmdlXTtcbiAgdXBkYXRlQW5jaG9yQW5kRm9jdXNGcm9tUmFuZ2Uoc2VsLCByYW5nZSwgZmFsc2UpO1xuICBzZWwucmFuZ2VDb3VudCA9IDE7XG4gIHNlbC5pc0NvbGxhcHNlZCA9IHJhbmdlLmNvbGxhcHNlZDtcbn1cblxuZnVuY3Rpb24gdXBkYXRlQ29udHJvbFNlbGVjdGlvbiAoc2VsKSB7XG4gIHNlbC5fcmFuZ2VzLmxlbmd0aCA9IDA7XG4gIGlmIChzZWwuX3NlbGVjdGlvbi50eXBlID09PSAnTm9uZScpIHtcbiAgICB1cGRhdGVFbXB0eVNlbGVjdGlvbihzZWwpO1xuICB9IGVsc2Uge1xuICAgIHZhciBjb250cm9sUmFuZ2UgPSBzZWwuX3NlbGVjdGlvbi5jcmVhdGVSYW5nZSgpO1xuICAgIGlmIChpc1RleHRSYW5nZShjb250cm9sUmFuZ2UpKSB7XG4gICAgICB1cGRhdGVGcm9tVGV4dFJhbmdlKHNlbCwgY29udHJvbFJhbmdlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgc2VsLnJhbmdlQ291bnQgPSBjb250cm9sUmFuZ2UubGVuZ3RoO1xuICAgICAgdmFyIHJhbmdlO1xuICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWwucmFuZ2VDb3VudDsgKytpKSB7XG4gICAgICAgIHJhbmdlID0gZG9jLmNyZWF0ZVJhbmdlKCk7XG4gICAgICAgIHJhbmdlLnNlbGVjdE5vZGUoY29udHJvbFJhbmdlLml0ZW0oaSkpO1xuICAgICAgICBzZWwuX3Jhbmdlcy5wdXNoKHJhbmdlKTtcbiAgICAgIH1cbiAgICAgIHNlbC5pc0NvbGxhcHNlZCA9IHNlbC5yYW5nZUNvdW50ID09PSAxICYmIHNlbC5fcmFuZ2VzWzBdLmNvbGxhcHNlZDtcbiAgICAgIHVwZGF0ZUFuY2hvckFuZEZvY3VzRnJvbVJhbmdlKHNlbCwgc2VsLl9yYW5nZXNbc2VsLnJhbmdlQ291bnQgLSAxXSwgZmFsc2UpO1xuICAgIH1cbiAgfVxufVxuXG5mdW5jdGlvbiBhZGRSYW5nZVRvQ29udHJvbFNlbGVjdGlvbiAoc2VsLCByYW5nZSkge1xuICB2YXIgY29udHJvbFJhbmdlID0gc2VsLl9zZWxlY3Rpb24uY3JlYXRlUmFuZ2UoKTtcbiAgdmFyIHJhbmdlRWxlbWVudCA9IGdldFNpbmdsZUVsZW1lbnRGcm9tUmFuZ2UocmFuZ2UpO1xuICB2YXIgbmV3Q29udHJvbFJhbmdlID0gYm9keS5jcmVhdGVDb250cm9sUmFuZ2UoKTtcbiAgZm9yICh2YXIgaSA9IDAsIGxlbiA9IGNvbnRyb2xSYW5nZS5sZW5ndGg7IGkgPCBsZW47ICsraSkge1xuICAgIG5ld0NvbnRyb2xSYW5nZS5hZGQoY29udHJvbFJhbmdlLml0ZW0oaSkpO1xuICB9XG4gIHRyeSB7XG4gICAgbmV3Q29udHJvbFJhbmdlLmFkZChyYW5nZUVsZW1lbnQpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdhZGRSYW5nZSgpOiBFbGVtZW50IGNvdWxkIG5vdCBiZSBhZGRlZCB0byBjb250cm9sIHNlbGVjdGlvbicpO1xuICB9XG4gIG5ld0NvbnRyb2xSYW5nZS5zZWxlY3QoKTtcbiAgdXBkYXRlQ29udHJvbFNlbGVjdGlvbihzZWwpO1xufVxuXG5mdW5jdGlvbiBpc1NhbWVSYW5nZSAobGVmdCwgcmlnaHQpIHtcbiAgcmV0dXJuIChcbiAgICBsZWZ0LnN0YXJ0Q29udGFpbmVyID09PSByaWdodC5zdGFydENvbnRhaW5lciAmJlxuICAgIGxlZnQuc3RhcnRPZmZzZXQgPT09IHJpZ2h0LnN0YXJ0T2Zmc2V0ICYmXG4gICAgbGVmdC5lbmRDb250YWluZXIgPT09IHJpZ2h0LmVuZENvbnRhaW5lciAmJlxuICAgIGxlZnQuZW5kT2Zmc2V0ID09PSByaWdodC5lbmRPZmZzZXRcbiAgKTtcbn1cblxuZnVuY3Rpb24gaXNBbmNlc3Rvck9mIChhbmNlc3RvciwgZGVzY2VuZGFudCkge1xuICB2YXIgbm9kZSA9IGRlc2NlbmRhbnQ7XG4gIHdoaWxlIChub2RlLnBhcmVudE5vZGUpIHtcbiAgICBpZiAobm9kZS5wYXJlbnROb2RlID09PSBhbmNlc3Rvcikge1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIG5vZGUgPSBub2RlLnBhcmVudE5vZGU7XG4gIH1cbiAgcmV0dXJuIGZhbHNlO1xufVxuXG5mdW5jdGlvbiBnZXRTZWxlY3Rpb24gKCkge1xuICByZXR1cm4gbmV3IEdldFNlbGVjdGlvbihnbG9iYWwuZG9jdW1lbnQuc2VsZWN0aW9uKTtcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBnZXRTZWxlY3Rpb247XG4iXX0=\n},{\"./rangeToTextRange\":10}],9:[function(require,module,exports){\n'use strict';\n\nfunction isHostMethod (host, prop) {\n  var type = typeof host[prop];\n  return type === 'function' || !!(type === 'object' && host[prop]) || type === 'unknown';\n}\n\nfunction isHostProperty (host, prop) {\n  return typeof host[prop] !== 'undefined';\n}\n\nfunction many (fn) {\n  return function areHosted (host, props) {\n    var i = props.length;\n    while (i--) {\n      if (!fn(host, props[i])) {\n        return false;\n      }\n    }\n    return true;\n  };\n}\n\nmodule.exports = {\n  method: isHostMethod,\n  methods: many(isHostMethod),\n  property: isHostProperty,\n  properties: many(isHostProperty)\n};\n\n},{}],10:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar doc = global.document;\nvar body = doc.body;\n\nfunction rangeToTextRange (p) {\n  if (p.collapsed) {\n    return createBoundaryTextRange({ node: p.startContainer, offset: p.startOffset }, true);\n  }\n  var startRange = createBoundaryTextRange({ node: p.startContainer, offset: p.startOffset }, true);\n  var endRange = createBoundaryTextRange({ node: p.endContainer, offset: p.endOffset }, false);\n  var textRange = body.createTextRange();\n  textRange.setEndPoint('StartToStart', startRange);\n  textRange.setEndPoint('EndToEnd', endRange);\n  return textRange;\n}\n\nfunction isCharacterDataNode (node) {\n  var t = node.nodeType;\n  return t === 3 || t === 4 || t === 8 ;\n}\n\nfunction createBoundaryTextRange (p, starting) {\n  var bound;\n  var parent;\n  var offset = p.offset;\n  var workingNode;\n  var childNodes;\n  var range = body.createTextRange();\n  var data = isCharacterDataNode(p.node);\n\n  if (data) {\n    bound = p.node;\n    parent = bound.parentNode;\n  } else {\n    childNodes = p.node.childNodes;\n    bound = offset < childNodes.length ? childNodes[offset] : null;\n    parent = p.node;\n  }\n\n  workingNode = doc.createElement('span');\n  workingNode.innerHTML = '&#feff;';\n\n  if (bound) {\n    parent.insertBefore(workingNode, bound);\n  } else {\n    parent.appendChild(workingNode);\n  }\n\n  range.moveToElementText(workingNode);\n  range.collapse(!starting);\n  parent.removeChild(workingNode);\n\n  if (data) {\n    range[starting ? 'moveStart' : 'moveEnd']('character', offset);\n  }\n  return range;\n}\n\nmodule.exports = rangeToTextRange;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9zZWxlY2Npb24vc3JjL3JhbmdlVG9UZXh0UmFuZ2UuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBkb2MgPSBnbG9iYWwuZG9jdW1lbnQ7XG52YXIgYm9keSA9IGRvYy5ib2R5O1xuXG5mdW5jdGlvbiByYW5nZVRvVGV4dFJhbmdlIChwKSB7XG4gIGlmIChwLmNvbGxhcHNlZCkge1xuICAgIHJldHVybiBjcmVhdGVCb3VuZGFyeVRleHRSYW5nZSh7IG5vZGU6IHAuc3RhcnRDb250YWluZXIsIG9mZnNldDogcC5zdGFydE9mZnNldCB9LCB0cnVlKTtcbiAgfVxuICB2YXIgc3RhcnRSYW5nZSA9IGNyZWF0ZUJvdW5kYXJ5VGV4dFJhbmdlKHsgbm9kZTogcC5zdGFydENvbnRhaW5lciwgb2Zmc2V0OiBwLnN0YXJ0T2Zmc2V0IH0sIHRydWUpO1xuICB2YXIgZW5kUmFuZ2UgPSBjcmVhdGVCb3VuZGFyeVRleHRSYW5nZSh7IG5vZGU6IHAuZW5kQ29udGFpbmVyLCBvZmZzZXQ6IHAuZW5kT2Zmc2V0IH0sIGZhbHNlKTtcbiAgdmFyIHRleHRSYW5nZSA9IGJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gIHRleHRSYW5nZS5zZXRFbmRQb2ludCgnU3RhcnRUb1N0YXJ0Jywgc3RhcnRSYW5nZSk7XG4gIHRleHRSYW5nZS5zZXRFbmRQb2ludCgnRW5kVG9FbmQnLCBlbmRSYW5nZSk7XG4gIHJldHVybiB0ZXh0UmFuZ2U7XG59XG5cbmZ1bmN0aW9uIGlzQ2hhcmFjdGVyRGF0YU5vZGUgKG5vZGUpIHtcbiAgdmFyIHQgPSBub2RlLm5vZGVUeXBlO1xuICByZXR1cm4gdCA9PT0gMyB8fCB0ID09PSA0IHx8IHQgPT09IDggO1xufVxuXG5mdW5jdGlvbiBjcmVhdGVCb3VuZGFyeVRleHRSYW5nZSAocCwgc3RhcnRpbmcpIHtcbiAgdmFyIGJvdW5kO1xuICB2YXIgcGFyZW50O1xuICB2YXIgb2Zmc2V0ID0gcC5vZmZzZXQ7XG4gIHZhciB3b3JraW5nTm9kZTtcbiAgdmFyIGNoaWxkTm9kZXM7XG4gIHZhciByYW5nZSA9IGJvZHkuY3JlYXRlVGV4dFJhbmdlKCk7XG4gIHZhciBkYXRhID0gaXNDaGFyYWN0ZXJEYXRhTm9kZShwLm5vZGUpO1xuXG4gIGlmIChkYXRhKSB7XG4gICAgYm91bmQgPSBwLm5vZGU7XG4gICAgcGFyZW50ID0gYm91bmQucGFyZW50Tm9kZTtcbiAgfSBlbHNlIHtcbiAgICBjaGlsZE5vZGVzID0gcC5ub2RlLmNoaWxkTm9kZXM7XG4gICAgYm91bmQgPSBvZmZzZXQgPCBjaGlsZE5vZGVzLmxlbmd0aCA/IGNoaWxkTm9kZXNbb2Zmc2V0XSA6IG51bGw7XG4gICAgcGFyZW50ID0gcC5ub2RlO1xuICB9XG5cbiAgd29ya2luZ05vZGUgPSBkb2MuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICB3b3JraW5nTm9kZS5pbm5lckhUTUwgPSAnJiNmZWZmOyc7XG5cbiAgaWYgKGJvdW5kKSB7XG4gICAgcGFyZW50Lmluc2VydEJlZm9yZSh3b3JraW5nTm9kZSwgYm91bmQpO1xuICB9IGVsc2Uge1xuICAgIHBhcmVudC5hcHBlbmRDaGlsZCh3b3JraW5nTm9kZSk7XG4gIH1cblxuICByYW5nZS5tb3ZlVG9FbGVtZW50VGV4dCh3b3JraW5nTm9kZSk7XG4gIHJhbmdlLmNvbGxhcHNlKCFzdGFydGluZyk7XG4gIHBhcmVudC5yZW1vdmVDaGlsZCh3b3JraW5nTm9kZSk7XG5cbiAgaWYgKGRhdGEpIHtcbiAgICByYW5nZVtzdGFydGluZyA/ICdtb3ZlU3RhcnQnIDogJ21vdmVFbmQnXSgnY2hhcmFjdGVyJywgb2Zmc2V0KTtcbiAgfVxuICByZXR1cm4gcmFuZ2U7XG59XG5cbm1vZHVsZS5leHBvcnRzID0gcmFuZ2VUb1RleHRSYW5nZTtcbiJdfQ==\n},{}],11:[function(require,module,exports){\n'use strict';\n\nvar getSelection = require('./getSelection');\nvar setSelection = require('./setSelection');\n\nmodule.exports = {\n  get: getSelection,\n  set: setSelection\n};\n\n},{\"./getSelection\":5,\"./setSelection\":12}],12:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar getSelection = require('./getSelection');\nvar rangeToTextRange = require('./rangeToTextRange');\nvar doc = global.document;\n\nfunction setSelection (p) {\n  if (doc.createRange) {\n    modernSelection();\n  } else {\n    oldSelection();\n  }\n\n  function modernSelection () {\n    var sel = getSelection();\n    var range = doc.createRange();\n    if (!p.startContainer) {\n      return;\n    }\n    if (p.endContainer) {\n      range.setEnd(p.endContainer, p.endOffset);\n    } else {\n      range.setEnd(p.startContainer, p.startOffset);\n    }\n    range.setStart(p.startContainer, p.startOffset);\n    sel.removeAllRanges();\n    sel.addRange(range);\n  }\n\n  function oldSelection () {\n    rangeToTextRange(p).select();\n  }\n}\n\nmodule.exports = setSelection;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9zZWxlY2Npb24vc3JjL3NldFNlbGVjdGlvbi5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCc7XG5cbnZhciBnZXRTZWxlY3Rpb24gPSByZXF1aXJlKCcuL2dldFNlbGVjdGlvbicpO1xudmFyIHJhbmdlVG9UZXh0UmFuZ2UgPSByZXF1aXJlKCcuL3JhbmdlVG9UZXh0UmFuZ2UnKTtcbnZhciBkb2MgPSBnbG9iYWwuZG9jdW1lbnQ7XG5cbmZ1bmN0aW9uIHNldFNlbGVjdGlvbiAocCkge1xuICBpZiAoZG9jLmNyZWF0ZVJhbmdlKSB7XG4gICAgbW9kZXJuU2VsZWN0aW9uKCk7XG4gIH0gZWxzZSB7XG4gICAgb2xkU2VsZWN0aW9uKCk7XG4gIH1cblxuICBmdW5jdGlvbiBtb2Rlcm5TZWxlY3Rpb24gKCkge1xuICAgIHZhciBzZWwgPSBnZXRTZWxlY3Rpb24oKTtcbiAgICB2YXIgcmFuZ2UgPSBkb2MuY3JlYXRlUmFuZ2UoKTtcbiAgICBpZiAoIXAuc3RhcnRDb250YWluZXIpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgaWYgKHAuZW5kQ29udGFpbmVyKSB7XG4gICAgICByYW5nZS5zZXRFbmQocC5lbmRDb250YWluZXIsIHAuZW5kT2Zmc2V0KTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmFuZ2Uuc2V0RW5kKHAuc3RhcnRDb250YWluZXIsIHAuc3RhcnRPZmZzZXQpO1xuICAgIH1cbiAgICByYW5nZS5zZXRTdGFydChwLnN0YXJ0Q29udGFpbmVyLCBwLnN0YXJ0T2Zmc2V0KTtcbiAgICBzZWwucmVtb3ZlQWxsUmFuZ2VzKCk7XG4gICAgc2VsLmFkZFJhbmdlKHJhbmdlKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIG9sZFNlbGVjdGlvbiAoKSB7XG4gICAgcmFuZ2VUb1RleHRSYW5nZShwKS5zZWxlY3QoKTtcbiAgfVxufVxuXG5tb2R1bGUuZXhwb3J0cyA9IHNldFNlbGVjdGlvbjtcbiJdfQ==\n},{\"./getSelection\":5,\"./rangeToTextRange\":10}],13:[function(require,module,exports){\n'use strict';\n\nvar get = easyGet;\nvar set = easySet;\n\nif (document.selection && document.selection.createRange) {\n  get = hardGet;\n  set = hardSet;\n}\n\nfunction easyGet (el) {\n  return {\n    start: el.selectionStart,\n    end: el.selectionEnd\n  };\n}\n\nfunction hardGet (el) {\n  var active = document.activeElement;\n  if (active !== el) {\n    el.focus();\n  }\n\n  var range = document.selection.createRange();\n  var bookmark = range.getBookmark();\n  var original = el.value;\n  var marker = getUniqueMarker(original);\n  var parent = range.parentElement();\n  if (parent === null || !inputs(parent)) {\n    return result(0, 0);\n  }\n  range.text = marker + range.text + marker;\n\n  var contents = el.value;\n\n  el.value = original;\n  range.moveToBookmark(bookmark);\n  range.select();\n\n  return result(contents.indexOf(marker), contents.lastIndexOf(marker) - marker.length);\n\n  function result (start, end) {\n    if (active !== el) { // don't disrupt pre-existing state\n      if (active) {\n        active.focus();\n      } else {\n        el.blur();\n      }\n    }\n    return { start: start, end: end };\n  }\n}\n\nfunction getUniqueMarker (contents) {\n  var marker;\n  do {\n    marker = '@@marker.' + Math.random() * new Date();\n  } while (contents.indexOf(marker) !== -1);\n  return marker;\n}\n\nfunction inputs (el) {\n  return ((el.tagName === 'INPUT' && el.type === 'text') || el.tagName === 'TEXTAREA');\n}\n\nfunction easySet (el, p) {\n  el.selectionStart = parse(el, p.start);\n  el.selectionEnd = parse(el, p.end);\n}\n\nfunction hardSet (el, p) {\n  var range = el.createTextRange();\n\n  if (p.start === 'end' && p.end === 'end') {\n    range.collapse(false);\n    range.select();\n  } else {\n    range.collapse(true);\n    range.moveEnd('character', parse(el, p.end));\n    range.moveStart('character', parse(el, p.start));\n    range.select();\n  }\n}\n\nfunction parse (el, value) {\n  return value === 'end' ? el.value.length : value || 0;\n}\n\nfunction sell (el, p) {\n  if (arguments.length === 2) {\n    set(el, p);\n  }\n  return get(el);\n}\n\nmodule.exports = sell;\n\n},{}],14:[function(require,module,exports){\n(function (global){\n'use strict';\n\nvar sell = require('sell');\nvar crossvent = require('crossvent');\nvar seleccion = require('seleccion');\nvar throttle = require('./throttle');\nvar getSelection = seleccion.get;\nvar props = [\n  'direction',\n  'boxSizing',\n  'width',\n  'height',\n  'overflowX',\n  'overflowY',\n  'borderTopWidth',\n  'borderRightWidth',\n  'borderBottomWidth',\n  'borderLeftWidth',\n  'paddingTop',\n  'paddingRight',\n  'paddingBottom',\n  'paddingLeft',\n  'fontStyle',\n  'fontVariant',\n  'fontWeight',\n  'fontStretch',\n  'fontSize',\n  'fontSizeAdjust',\n  'lineHeight',\n  'fontFamily',\n  'textAlign',\n  'textTransform',\n  'textIndent',\n  'textDecoration',\n  'letterSpacing',\n  'wordSpacing'\n];\nvar win = global;\nvar doc = document;\nvar ff = win.mozInnerScreenX !== null && win.mozInnerScreenX !== void 0;\n\nfunction tailormade (el, options) {\n  var textInput = el.tagName === 'INPUT' || el.tagName === 'TEXTAREA';\n  var throttledRefresh = throttle(refresh, 30);\n  var o = options || {};\n\n  bind();\n\n  return {\n    read: readPosition,\n    refresh: throttledRefresh,\n    destroy: destroy\n  };\n\n  function noop () {}\n  function readPosition () { return (textInput ? coordsText : coordsHTML)(); }\n\n  function refresh () {\n    if (o.sleeping) {\n      return;\n    }\n    return (o.update || noop)(readPosition());\n  }\n\n  function coordsText () {\n    var p = sell(el);\n    var context = prepare();\n    var readings = readTextCoords(context, p.start);\n    doc.body.removeChild(context.mirror);\n    return readings;\n  }\n\n  function coordsHTML () {\n    var sel = getSelection();\n    if (sel.rangeCount) {\n      var range = sel.getRangeAt(0);\n      var needsToWorkAroundNewlineBug = range.startContainer.nodeName === 'P' && range.startOffset === 0;\n      if (needsToWorkAroundNewlineBug) {\n        return {\n          x: range.startContainer.offsetLeft,\n          y: range.startContainer.offsetTop,\n          absolute: true\n        };\n      }\n      if (range.getClientRects) {\n        var rects = range.getClientRects();\n        if (rects.length > 0) {\n          return {\n            x: rects[0].left,\n            y: rects[0].top,\n            absolute: true\n          };\n        }\n      }\n    }\n    return { x: 0, y: 0 };\n  }\n\n  function readTextCoords (context, p) {\n    var rest = doc.createElement('span');\n    var mirror = context.mirror;\n    var computed = context.computed;\n\n    write(mirror, read(el).substring(0, p));\n\n    if (el.tagName === 'INPUT') {\n      mirror.textContent = mirror.textContent.replace(/\\s/g, '\\u00a0');\n    }\n\n    write(rest, read(el).substring(p) || '.');\n\n    mirror.appendChild(rest);\n\n    return {\n      x: rest.offsetLeft + parseInt(computed['borderLeftWidth']),\n      y: rest.offsetTop + parseInt(computed['borderTopWidth'])\n    };\n  }\n\n  function read (el) {\n    return textInput ? el.value : el.innerHTML;\n  }\n\n  function prepare () {\n    var computed = win.getComputedStyle ? getComputedStyle(el) : el.currentStyle;\n    var mirror = doc.createElement('div');\n    var style = mirror.style;\n\n    doc.body.appendChild(mirror);\n\n    if (el.tagName !== 'INPUT') {\n      style.wordWrap = 'break-word';\n    }\n    style.whiteSpace = 'pre-wrap';\n    style.position = 'absolute';\n    style.visibility = 'hidden';\n    props.forEach(copy);\n\n    if (ff) {\n      style.width = parseInt(computed.width) - 2 + 'px';\n      if (el.scrollHeight > parseInt(computed.height)) {\n        style.overflowY = 'scroll';\n      }\n    } else {\n      style.overflow = 'hidden';\n    }\n    return { mirror: mirror, computed: computed };\n\n    function copy (prop) {\n      style[prop] = computed[prop];\n    }\n  }\n\n  function write (el, value) {\n    if (textInput) {\n      el.textContent = value;\n    } else {\n      el.innerHTML = value;\n    }\n  }\n\n  function bind (remove) {\n    var op = remove ? 'remove' : 'add';\n    crossvent[op](el, 'keydown', throttledRefresh);\n    crossvent[op](el, 'keyup', throttledRefresh);\n    crossvent[op](el, 'input', throttledRefresh);\n    crossvent[op](el, 'paste', throttledRefresh);\n    crossvent[op](el, 'change', throttledRefresh);\n  }\n\n  function destroy () {\n    bind(true);\n  }\n}\n\nmodule.exports = tailormade;\n\n}).call(this,typeof global !== \"undefined\" ? global : typeof self !== \"undefined\" ? self : typeof window !== \"undefined\" ? window : {})\n//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInRhaWxvcm1hZGUuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiJ3VzZSBzdHJpY3QnO1xuXG52YXIgc2VsbCA9IHJlcXVpcmUoJ3NlbGwnKTtcbnZhciBjcm9zc3ZlbnQgPSByZXF1aXJlKCdjcm9zc3ZlbnQnKTtcbnZhciBzZWxlY2Npb24gPSByZXF1aXJlKCdzZWxlY2Npb24nKTtcbnZhciB0aHJvdHRsZSA9IHJlcXVpcmUoJy4vdGhyb3R0bGUnKTtcbnZhciBnZXRTZWxlY3Rpb24gPSBzZWxlY2Npb24uZ2V0O1xudmFyIHByb3BzID0gW1xuICAnZGlyZWN0aW9uJyxcbiAgJ2JveFNpemluZycsXG4gICd3aWR0aCcsXG4gICdoZWlnaHQnLFxuICAnb3ZlcmZsb3dYJyxcbiAgJ292ZXJmbG93WScsXG4gICdib3JkZXJUb3BXaWR0aCcsXG4gICdib3JkZXJSaWdodFdpZHRoJyxcbiAgJ2JvcmRlckJvdHRvbVdpZHRoJyxcbiAgJ2JvcmRlckxlZnRXaWR0aCcsXG4gICdwYWRkaW5nVG9wJyxcbiAgJ3BhZGRpbmdSaWdodCcsXG4gICdwYWRkaW5nQm90dG9tJyxcbiAgJ3BhZGRpbmdMZWZ0JyxcbiAgJ2ZvbnRTdHlsZScsXG4gICdmb250VmFyaWFudCcsXG4gICdmb250V2VpZ2h0JyxcbiAgJ2ZvbnRTdHJldGNoJyxcbiAgJ2ZvbnRTaXplJyxcbiAgJ2ZvbnRTaXplQWRqdXN0JyxcbiAgJ2xpbmVIZWlnaHQnLFxuICAnZm9udEZhbWlseScsXG4gICd0ZXh0QWxpZ24nLFxuICAndGV4dFRyYW5zZm9ybScsXG4gICd0ZXh0SW5kZW50JyxcbiAgJ3RleHREZWNvcmF0aW9uJyxcbiAgJ2xldHRlclNwYWNpbmcnLFxuICAnd29yZFNwYWNpbmcnXG5dO1xudmFyIHdpbiA9IGdsb2JhbDtcbnZhciBkb2MgPSBkb2N1bWVudDtcbnZhciBmZiA9IHdpbi5tb3pJbm5lclNjcmVlblggIT09IG51bGwgJiYgd2luLm1veklubmVyU2NyZWVuWCAhPT0gdm9pZCAwO1xuXG5mdW5jdGlvbiB0YWlsb3JtYWRlIChlbCwgb3B0aW9ucykge1xuICB2YXIgdGV4dElucHV0ID0gZWwudGFnTmFtZSA9PT0gJ0lOUFVUJyB8fCBlbC50YWdOYW1lID09PSAnVEVYVEFSRUEnO1xuICB2YXIgdGhyb3R0bGVkUmVmcmVzaCA9IHRocm90dGxlKHJlZnJlc2gsIDMwKTtcbiAgdmFyIG8gPSBvcHRpb25zIHx8IHt9O1xuXG4gIGJpbmQoKTtcblxuICByZXR1cm4ge1xuICAgIHJlYWQ6IHJlYWRQb3NpdGlvbixcbiAgICByZWZyZXNoOiB0aHJvdHRsZWRSZWZyZXNoLFxuICAgIGRlc3Ryb3k6IGRlc3Ryb3lcbiAgfTtcblxuICBmdW5jdGlvbiBub29wICgpIHt9XG4gIGZ1bmN0aW9uIHJlYWRQb3NpdGlvbiAoKSB7IHJldHVybiAodGV4dElucHV0ID8gY29vcmRzVGV4dCA6IGNvb3Jkc0hUTUwpKCk7IH1cblxuICBmdW5jdGlvbiByZWZyZXNoICgpIHtcbiAgICBpZiAoby5zbGVlcGluZykge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICByZXR1cm4gKG8udXBkYXRlIHx8IG5vb3ApKHJlYWRQb3NpdGlvbigpKTtcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvb3Jkc1RleHQgKCkge1xuICAgIHZhciBwID0gc2VsbChlbCk7XG4gICAgdmFyIGNvbnRleHQgPSBwcmVwYXJlKCk7XG4gICAgdmFyIHJlYWRpbmdzID0gcmVhZFRleHRDb29yZHMoY29udGV4dCwgcC5zdGFydCk7XG4gICAgZG9jLmJvZHkucmVtb3ZlQ2hpbGQoY29udGV4dC5taXJyb3IpO1xuICAgIHJldHVybiByZWFkaW5ncztcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvb3Jkc0hUTUwgKCkge1xuICAgIHZhciBzZWwgPSBnZXRTZWxlY3Rpb24oKTtcbiAgICBpZiAoc2VsLnJhbmdlQ291bnQpIHtcbiAgICAgIHZhciByYW5nZSA9IHNlbC5nZXRSYW5nZUF0KDApO1xuICAgICAgdmFyIG5lZWRzVG9Xb3JrQXJvdW5kTmV3bGluZUJ1ZyA9IHJhbmdlLnN0YXJ0Q29udGFpbmVyLm5vZGVOYW1lID09PSAnUCcgJiYgcmFuZ2Uuc3RhcnRPZmZzZXQgPT09IDA7XG4gICAgICBpZiAobmVlZHNUb1dvcmtBcm91bmROZXdsaW5lQnVnKSB7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgeDogcmFuZ2Uuc3RhcnRDb250YWluZXIub2Zmc2V0TGVmdCxcbiAgICAgICAgICB5OiByYW5nZS5zdGFydENvbnRhaW5lci5vZmZzZXRUb3AsXG4gICAgICAgICAgYWJzb2x1dGU6IHRydWVcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIGlmIChyYW5nZS5nZXRDbGllbnRSZWN0cykge1xuICAgICAgICB2YXIgcmVjdHMgPSByYW5nZS5nZXRDbGllbnRSZWN0cygpO1xuICAgICAgICBpZiAocmVjdHMubGVuZ3RoID4gMCkge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB4OiByZWN0c1swXS5sZWZ0LFxuICAgICAgICAgICAgeTogcmVjdHNbMF0udG9wLFxuICAgICAgICAgICAgYWJzb2x1dGU6IHRydWVcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB7IHg6IDAsIHk6IDAgfTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHJlYWRUZXh0Q29vcmRzIChjb250ZXh0LCBwKSB7XG4gICAgdmFyIHJlc3QgPSBkb2MuY3JlYXRlRWxlbWVudCgnc3BhbicpO1xuICAgIHZhciBtaXJyb3IgPSBjb250ZXh0Lm1pcnJvcjtcbiAgICB2YXIgY29tcHV0ZWQgPSBjb250ZXh0LmNvbXB1dGVkO1xuXG4gICAgd3JpdGUobWlycm9yLCByZWFkKGVsKS5zdWJzdHJpbmcoMCwgcCkpO1xuXG4gICAgaWYgKGVsLnRhZ05hbWUgPT09ICdJTlBVVCcpIHtcbiAgICAgIG1pcnJvci50ZXh0Q29udGVudCA9IG1pcnJvci50ZXh0Q29udGVudC5yZXBsYWNlKC9cXHMvZywgJ1xcdTAwYTAnKTtcbiAgICB9XG5cbiAgICB3cml0ZShyZXN0LCByZWFkKGVsKS5zdWJzdHJpbmcocCkgfHwgJy4nKTtcblxuICAgIG1pcnJvci5hcHBlbmRDaGlsZChyZXN0KTtcblxuICAgIHJldHVybiB7XG4gICAgICB4OiByZXN0Lm9mZnNldExlZnQgKyBwYXJzZUludChjb21wdXRlZFsnYm9yZGVyTGVmdFdpZHRoJ10pLFxuICAgICAgeTogcmVzdC5vZmZzZXRUb3AgKyBwYXJzZUludChjb21wdXRlZFsnYm9yZGVyVG9wV2lkdGgnXSlcbiAgICB9O1xuICB9XG5cbiAgZnVuY3Rpb24gcmVhZCAoZWwpIHtcbiAgICByZXR1cm4gdGV4dElucHV0ID8gZWwudmFsdWUgOiBlbC5pbm5lckhUTUw7XG4gIH1cblxuICBmdW5jdGlvbiBwcmVwYXJlICgpIHtcbiAgICB2YXIgY29tcHV0ZWQgPSB3aW4uZ2V0Q29tcHV0ZWRTdHlsZSA/IGdldENvbXB1dGVkU3R5bGUoZWwpIDogZWwuY3VycmVudFN0eWxlO1xuICAgIHZhciBtaXJyb3IgPSBkb2MuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgdmFyIHN0eWxlID0gbWlycm9yLnN0eWxlO1xuXG4gICAgZG9jLmJvZHkuYXBwZW5kQ2hpbGQobWlycm9yKTtcblxuICAgIGlmIChlbC50YWdOYW1lICE9PSAnSU5QVVQnKSB7XG4gICAgICBzdHlsZS53b3JkV3JhcCA9ICdicmVhay13b3JkJztcbiAgICB9XG4gICAgc3R5bGUud2hpdGVTcGFjZSA9ICdwcmUtd3JhcCc7XG4gICAgc3R5bGUucG9zaXRpb24gPSAnYWJzb2x1dGUnO1xuICAgIHN0eWxlLnZpc2liaWxpdHkgPSAnaGlkZGVuJztcbiAgICBwcm9wcy5mb3JFYWNoKGNvcHkpO1xuXG4gICAgaWYgKGZmKSB7XG4gICAgICBzdHlsZS53aWR0aCA9IHBhcnNlSW50KGNvbXB1dGVkLndpZHRoKSAtIDIgKyAncHgnO1xuICAgICAgaWYgKGVsLnNjcm9sbEhlaWdodCA+IHBhcnNlSW50KGNvbXB1dGVkLmhlaWdodCkpIHtcbiAgICAgICAgc3R5bGUub3ZlcmZsb3dZID0gJ3Njcm9sbCc7XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHN0eWxlLm92ZXJmbG93ID0gJ2hpZGRlbic7XG4gICAgfVxuICAgIHJldHVybiB7IG1pcnJvcjogbWlycm9yLCBjb21wdXRlZDogY29tcHV0ZWQgfTtcblxuICAgIGZ1bmN0aW9uIGNvcHkgKHByb3ApIHtcbiAgICAgIHN0eWxlW3Byb3BdID0gY29tcHV0ZWRbcHJvcF07XG4gICAgfVxuICB9XG5cbiAgZnVuY3Rpb24gd3JpdGUgKGVsLCB2YWx1ZSkge1xuICAgIGlmICh0ZXh0SW5wdXQpIHtcbiAgICAgIGVsLnRleHRDb250ZW50ID0gdmFsdWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGVsLmlubmVySFRNTCA9IHZhbHVlO1xuICAgIH1cbiAgfVxuXG4gIGZ1bmN0aW9uIGJpbmQgKHJlbW92ZSkge1xuICAgIHZhciBvcCA9IHJlbW92ZSA/ICdyZW1vdmUnIDogJ2FkZCc7XG4gICAgY3Jvc3N2ZW50W29wXShlbCwgJ2tleWRvd24nLCB0aHJvdHRsZWRSZWZyZXNoKTtcbiAgICBjcm9zc3ZlbnRbb3BdKGVsLCAna2V5dXAnLCB0aHJvdHRsZWRSZWZyZXNoKTtcbiAgICBjcm9zc3ZlbnRbb3BdKGVsLCAnaW5wdXQnLCB0aHJvdHRsZWRSZWZyZXNoKTtcbiAgICBjcm9zc3ZlbnRbb3BdKGVsLCAncGFzdGUnLCB0aHJvdHRsZWRSZWZyZXNoKTtcbiAgICBjcm9zc3ZlbnRbb3BdKGVsLCAnY2hhbmdlJywgdGhyb3R0bGVkUmVmcmVzaCk7XG4gIH1cblxuICBmdW5jdGlvbiBkZXN0cm95ICgpIHtcbiAgICBiaW5kKHRydWUpO1xuICB9XG59XG5cbm1vZHVsZS5leHBvcnRzID0gdGFpbG9ybWFkZTtcbiJdfQ==\n},{\"./throttle\":15,\"crossvent\":3,\"seleccion\":11,\"sell\":13}],15:[function(require,module,exports){\n'use strict';\n\nfunction throttle (fn, boundary) {\n  var last = -Infinity;\n  var timer;\n  return function bounced () {\n    if (timer) {\n      return;\n    }\n    unbound();\n\n    function unbound () {\n      clearTimeout(timer);\n      timer = null;\n      var next = last + boundary;\n      var now = Date.now();\n      if (now > next) {\n        last = now;\n        fn();\n      } else {\n        timer = setTimeout(unbound, next - now);\n      }\n    }\n  };\n}\n\nmodule.exports = throttle;\n\n},{}]},{},[1])(1)\n});\n",
    "define('auto-complete',['../lib/bullseye'], function(bullseye){\n\t\n\treturn Backbone.View.extend({\n\t\t\n\t\tclassName: 'token-editor-auto-complete',\n\t\t\n\t\tmenu: [],\n\t\t\n\t\t_defaultOptions: {\n\t\t\titems: [],\n\t\t\tminLen: 2,\n\t\t\tmaxResults: 4,\n\t\t\tminScore: 0.9\n\t\t},\n\t\t\n\t\tevents: {\n\t\t\t'click > div': 'onClick'\n\t\t},\n\t\t\n\t\tinitialize: function(){\n\t\t\t\n\t\t\tthis.options = _.extend(this._defaultOptions, this.options||{});\n\t\t\t\n\t\t\tdocument.body.appendChild( this.el );\n\t\t\t\n\t\t\tthis.position = bullseye(this.el, this.options.target, {\n\t\t\t\tcaret: true,\n\t\t\t\tautoupdateToCaret: true\n\t\t\t})\n\t\t\t\n\t\t\tthis.hide();\n\t\t},\n\t\t\n\t\tsetItems: function(items){\n\t\t\tthis.options.items = items\n\t\t},\n\t\t\n\t\tbindKeyboardEvents: function(){\n\t\t\tthis.onKeydown = this.onKeydown || this._onKeydown.bind(this)\n\t\t\tthis.onKeyup = this.onKeyup || this._onKeyup.bind(this)\n\t\t\tdocument.body.addEventListener('keydown', this.onKeydown, true)\n\t\t\tdocument.body.addEventListener('keyup', this.onKeyup, true)\n\t\t},\n\t\t\n\t\tunbindKeyboardEvents: function(){\n\t\t\tdocument.body.removeEventListener('keydown', this.onKeydown, true)\n\t\t\tdocument.body.removeEventListener('keyup', this.onKeyup, true)\n\t\t},\n\t\t\n\t\t_onKeydown: function(e){\n\t\t\t\n\t\t\tif( e.which == 27 || e.which == 38 || e.which == 40 || e.which == 13 || e.which == 9 ){\n\t\t\t\t\n\t\t\t\tif( e.which == 27 ) // esc\n\t\t\t\t\tthis.hide();\n\t\t\t\telse if( e.which == 13 || e.which == 9 ) // enter or tab\n\t\t\t\t\tthis.onSelect()\n\t\t\t\telse if( e.which == 38 ) // up\n\t\t\t\t\tthis.selectPrev();\n\t\t\t\telse if( e.which == 40 ) // down\n\t\t\t\t\tthis.selectNext();\n\t\t\t\t\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation()\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t},\n\t\t\n\t\t_onKeyup: function(e){\n\t\t\tif( e.which == 27 || e.which == 38 || e.which == 40 || e.which == 13 ){\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation()\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t\n\t\tselectPrev: function(){\n\t\t\tthis._selectIndex( this.selected - 1 < 0 ? this.menu.length -1 : this.selected - 1)\n\t\t},\n\t\t\n\t\tselectNext: function(){\n\t\t\tthis._selectIndex( this.selected + 1 >= this.menu.length ? 0 : this.selected + 1)\n\t\t},\n\t\t\n\t\t_selectIndex: function(indx){\n\t\t\tthis.el.childNodes[this.selected].classList.remove('selected')\n\t\t\tthis.el.childNodes[indx].classList.add('selected')\n\t\t\tthis.selected = indx;\n\t\t},\n\t\t\n\t\tonClick: function(e){\n\t\t\tModal.alert('Use the <u>up</u> and <u>down</u> keys and press <code>enter</code> to select.')\n\t\t\t/*var el = e.currentTarget;\n\t\t\tthis.selected = Array.prototype.indexOf.call(el.parentNode.childNodes, el);\n\t\t\tconsole.log(this.selected, el);\n\t\t\tthis.onSelect();*/\n\t\t},\n\t\t\n\t\tonSelect: function(){\n\t\t\tthis.trigger('select', this.menu[this.selected], this)\n\t\t},\n\t\t\n\t\trender: function(word){\n\t\t\t\n\t\t\tthis.$el.html('')\n\t\t\t\n\t\t\tif( !word || word.length < this.options.minLen ){\n\t\t\t\tthis.hide();\n\t\t\t\t\n\t\t\t}else{\n\t\t\t\tthis.menuFor(word)\n\t\t\t\t\n\t\t\t\tif( this.menu.length > 0 ){\n\t\t\t\t\tthis.show();\n\t\t\t\t\tthis.selected = 0;\n\t\t\t\t\tthis.menu.forEach(this.addMenuItem.bind(this))\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t\n\t\taddMenuItem: function(m, indx){\n\t\t\tthis.$el.append('<div class=\"'+(indx==this.selected?'selected':'')+'\" data=id=\"'+m.id+'\">'+m.label+'</div>')\n\t\t},\n\t\t\n\t\t_score: function(str, term){\n\t\t\tif( typeof LiquidMetal === 'undefined' && !this._noScoreWarning ){\n\t\t\t\tthis._noScoreWarning = true;\n\t\t\t\tconsole.warn('TokenEditor: cannot score auto complete results; LiquidMetal plugin is missing.');\n\t\t\t\treturn 1;\n\t\t\t}\n\t\t\telse{\n\t\t\t\treturn LiquidMetal.score(str, term)\n\t\t\t}\n\t\t},\n\t\t\n\t\t_scoreItem: function(m, word){\n\t\t\tvar scores = []\n\t\t\t\n\t\t\tscores.push(this._score(m.label, word))\n\t\t\t\n\t\t\t// simple string hint\n\t\t\tif( m.hint && typeof m.hint == 'string' )\n\t\t\t\tscores.push(this._score(m.hint, word))\n\t\t\t\n\t\t\t// array of hints\n\t\t\tif( m.hint && Array.isArray(m.hint) )\n\t\t\t\tm.hint.forEach(function(str){\n\t\t\t\t\tscores.push(this._score(str, word))\n\t\t\t\t})\n\t\t\t\n\t\t\treturn scores.sort().pop() // return the highest score\n\t\t},\n\t\t\n\t\tmenuFor: function(word){\n\t\t\tvar menu = [];\n\t\t\t\n\t\t\tif( this.options.items )\n\t\t\tthis.options.items.forEach(function(m){\n\t\t\t\t\n\t\t\t\tvar score = this._scoreItem(m, word);\n\t\t\t\t\n\t\t\t\tif( score >= this.options.minScore ){\n\t\t\t\t\t\n\t\t\t\t\tm.score = score;\n\t\t\t\t\t\n\t\t\t\t\tmenu.push(m)\n\t\t\t\t}\n\t\t\t}.bind(this))\n\t\t\t\n\t\t\t_.sortBy(menu, function(m){ return m.score })\n\t\t\t\n\t\t\treturn this.menu = menu;\n\t\t},\n\t\t\n\t\tshow: function(){\n\t\t\t\n\t\t\tif( this.isShowing ) return;\n\t\t\t\n\t\t\tthis.isShowing = true\n\t\t\tthis.el.classList.add('show')\n\t\t\tthis.bindKeyboardEvents();\n\t\t\tthis.position.refresh();\n\t\t},\n\t\t\n\t\thide: function(){\n\t\t\tthis.isShowing = false;\n\t\t\tthis.el.classList.remove('show')\n\t\t\tthis.unbindKeyboardEvents();\n\t\t\tthis.position.sleep();\n\t\t}\n\t\t\n\t})\n\t\n});\n",
    "/*\n\tToken Editor 0.2.0\n\t\n\tA basic text editor with tokens that are used via auto-complete.\n\tTokens can not be modified by the keyboard but appear as \"objects\" within\n\tthe text box.\n\t\n\tThis plugin merges the idea of a \"tag list\" and \"@mention\" auto-complete.\n\t\n\thttp://kjantzer.github.io/backbone-token-editor/\n\t\n\t@author Kevin Jantzer, Blackstone Audio Inc.\n\t@since 2015-08-24\n\t\n\t@DEPENDENCIES\n\t[Bullseye](https://github.com/bevacqua/bullseye)\n\t\n\tTODO:\n\t- `&nbsp;` appears sometimes when typing after a token\n\t- maybe remove need for Backbone.subviews?\n\t- with multiLines:false, think about adding styles and code to make it perform more like an input\n\t\n*/\ndefine('token-editor',['auto-complete'], function(AutoCompleteView){\n\t\n\treturn Backbone.View.extend({\n\t\t\n\t\tclassName: 'token-editor',\n\t\t\n\t\t_defaultOptions: {\n\t\t\tclassName: '',\n\t\t\tvalue: '',\t\t\t\t// html string or JSON format,\n\t\t\tautoComplete: {},\t\t// options for auto complete\n\t\t\tmultiLines: true,\n\t\t\tallowPaste: false,\n\t\t\tallowStyling: false,\t// bold/italics keyboard shorcuts\n\t\t\tediting: false, \t\t// set to true if you want to be in edit mode upon init\n\t\t\tdblClickToEdit: true\n\t\t},\n\t\t\n\t\tevents: {\n\t\t\t'dblclick': 'onDblClick',\n\t\t\t'click': 'onClick',\n\t\t\t'blur': 'onBlur',\n\t\t\t'keydown': 'onKeydown',\n\t\t\t'keyup': 'onKeyup',\n\t\t\t'keypress': 'onKeypress',\n\t\t\t'paste': 'onPaste'\n\t\t},\n\t\t\n\t\tinitialize: function(){\n\t\t\t\n\t\t\twindow.tokenEditor = this; // TEMP\n\t\t\t\n\t\t\tthis.options = _.extend({}, this._defaultOptions, this.options||{});\n\t\t\tthis.history =[];\n\t\t\tthis.historyAt = 0;\n\t\t\t\n\t\t\tif( this.options.className )\n\t\t\t\tthis.el.classList.add(this.options.className)\n\t\t\t\n\t\t\tvar autoCompleteOptions = this.options.autoComplete;\n\t\t\tautoCompleteOptions.target = this.el;\n\t\t\t\n\t\t\tthis.subview('auto-complete') || this.subview('auto-complete', new AutoCompleteView(autoCompleteOptions))\n\t\t\tthis.listenTo(this.subview('auto-complete'), 'select', this.onAutoCompleteSelect)\n\t\t\t\n\t\t\tif( this.options.items )\n\t\t\t\tthis.setAutoCompleteItems(this.options.items)\n\t\t\t\t\n\t\t\tthis.setValue()\n\t\t\tthis.markHistory();\n\t\t\t\n\t\t\tif( this.options.editing )\n\t\t\t\tthis.edit();\n\t\t},\n\t\t\n\t\tisEditing: function(){\n\t\t\treturn this.el.contentEditable == 'true'\n\t\t},\n\t\t\n\t\tedit: function(doEdit){\n\t\t\tthis.el.contentEditable = doEdit !== false\n\t\t},\n\t\t\n\t\trender: function(){\n\t\t\t\n\t\t\tthis.delegateEvents();\n\t\t\t\n\t\t\treturn this;\n\t\t},\n\t\t\n\t\tsetValue: function(val){\n\t\t\t\n\t\t\tif( arguments.length == 0 )\n\t\t\t\tval = this.options.value;\n\t\t\telse\n\t\t\t\tthis.options.value = val;\n\t\t\t\t\n\t\t\tvar html = typeof val == 'string' ? val : this.jsonToHTML(val)\n\t\t\t\n\t\t\tthis.el.innerHTML = html;\n\t\t\t\n\t\t\thtml ? this.el.classList.remove('empty') : this.el.classList.add('empty')\n\t\t\t\n\t\t\tthis.endWithBrTag();\n\t\t},\n\t\t\n\t\t// sets the items available in 'auto complete'\n\t\tsetAutoCompleteItems: function(items){\n\t\t\tthis.items = items;\n\t\t\tthis.subview('auto-complete').setItems(items);\n\t\t},\n\t\t\n\t\t// when a users selects an 'auto complete' item\n\t\tonAutoCompleteSelect: function(data, autoComplete){\n\t\t\tautoComplete.hide();\n\t\t\tthis.replaceWithToken(data)\n\t\t},\n\t\t\n\t\tonDblClick: function(){\n\t\t\tif( this.options.dblClickToEdit == true && !this.isEditing() ){\n\t\t\t\tthis.edit(true)\n\t\t\t\tthis.focusEnd();\n\t\t\t}\n\t\t},\n\t\t\n\t\t// when clicked somewhere else in the editor, hide auto complete\n\t\tonClick: function(){ this.subview('auto-complete').hide(); },\n\t\tonBlur: function(){ this.subview('auto-complete').hide(); this.trigger('blur', this) },\n\t\t\n\t\tmakeToken: function(d){\n\t\t\tvar node = document.createElement('span');\n\t\t\tnode.contentEditable = false;\n\t\t\tnode.classList.add('token');\n\t\t\t\n\t\t\t_.each(d.attrs, function(val, key){\n\t\t\t\tnode.setAttribute('data-'+key, val);\n\t\t\t})\n\t\t\t\n\t\t\tvar label = document.createElement('span');\n\t\t\tlabel.innerHTML = d.label;\n\t\t\tnode.appendChild(label)\n\t\t\t\n\t\t\treturn node.outerHTML;\n\t\t\t\n\t\t\treturn '<span contenteditable=false class=\"token\" data-id=\"'+d.id+'\"><span>'+d.label+'</span></span>';\n\t\t},\n\t\t\n\t\tinsertToken: function(d){\n\t\t\tthis.insertHTML( this.makeToken(d) )\n\t\t},\n\t\t\n\t\treplaceWithToken: function(token){\n\t\t\t\n\t\t\tclearTimeout( this.historyTimeout )\n\t\t\t\n\t\t\tvar sel = window.getSelection(),\n\t\t\t\trange = sel.getRangeAt(0),\n\t\t\t\ttext = range.endContainer.textContent.slice(0, range.endOffset ),\n\t\t\t\tlastSpace = text.lastIndexOf(' ') > -1 ? text.lastIndexOf(' ') : text.lastIndexOf('');\n\t\t\t\tword = lastSpace > -1 ? text.slice(lastSpace+1) : text;\n\t\t\t\n\t\t\t// delete the word the user was typing so we can replace it with a token\n\t\t\trange.setStart(range.endContainer, lastSpace+1);\n\t\t\trange.deleteContents();\n\t\t\t\n\t\t\tthis.insertToken(token);\n\t\t},\n\t\t\n\t\tcurrentWord: function(){\n\t\t\t\t\n\t\t\tvar sel = window.getSelection(),\n\t\t\t\trange = sel.getRangeAt(0);\n\t\t\t\n\t\t\tif( range.endContainer == this.el \n\t\t\t|| !range.endContainer.textContent ) return;\n\t\t\t\n\t\t\tvar text = range.endContainer.textContent.slice(0, range.endOffset ),\n\t\t\t\tlastSpace = text.lastIndexOf(' ') > -1 ? text.lastIndexOf(' ') : text.lastIndexOf('');\n\t\t\t\tword = lastSpace > -1 ? text.slice(lastSpace+1) : text;\n\t\t\t\n\t\t\t//console.log('current word: ', word);\n\t\t\treturn word;\n\t\t},\n\t\t\n\t\tonPaste: function(e){\n\t\t\tif( this.options.allowPaste != true ){\n\t\t\t\te.preventDefault(); // disable pasting so we dont have to do style cleanup\n\t\t\t\treturn false;\n\t\t\t}else{\n\t\t\t\tthis.markHistoryIn(0);\n\t\t\t}\n\t\t},\n\t\t\n\t\tonKeydown: function(e){\n\t\t\t\n\t\t\tif( e.which === 27 ){ // esc\n\t\t\t\tthis.trigger('cancel', this)\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t\n\t\t\t// disable style commands like bold an italic\n\t\t\tif( this.metaKey() && (e.keyCode === 66 /* bold */ || e.keyCode === 73 /* italics */)){\n\t\t\t\t\n\t\t\t\tif( this.options.allowStyling !== true )\n\t\t\t\t\treturn false;\n\t\t\t\telse\n\t\t\t\t\tthis.markHistoryIn(0);\n\t\t\t}\n\t\t\t\n\t\t\t// override undo/redo for our own built in history manager\n\t\t\tif( this.metaKey() && e.keyCode === 90 ){ // ctrl/cmd + z\n\t\t\t\te.shiftKey ? this.redo() : this.undo()\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\t\n\t\t\t// on enter, force `<br>` tags instead of <div> or <p>\n\t\t\tif (e.keyCode === 13) {\n\t\t\t\t\n\t\t\t\tif( this.options.multiLines != true ) return false;\n\t\t\t\t\n\t\t\t\t// if at the end of editor, a trailing <br> is needed to make the cursor jump to the next line\n\t\t\t\tif( this.getSelection().start >= this.length() )\n\t\t\t\t\tdocument.execCommand('insertHTML', false, '<br class=\"newline\"><br>');\n\t\t\t\telse\n\t\t\t\t\tdocument.execCommand('insertHTML', false, '<br class=\"newline\">');\n\t\t\t\t\t\n\t\t\t\tthis.markHistoryIn(0);\n\t\t\t\t\n\t\t\t\treturn false;\n\t\t\t}\n\t\t},\n\t\t\n\t\tonKeyup: function(e){\n\t\t\t\n\t\t\t// re-render auto-complete with the current word\n\t\t\t_.defer(function(){\n\t\t\t\tthis.subview('auto-complete').render( this.currentWord() )\n\t\t\t}.bind(this))\n\t\t\t\n\t\t\t// backspace\n\t\t\tif( e.which == 8 )\n\t\t\t\tthis.markHistoryIn(500);\n\t\t\t\n\t\t\t// make sure we end with a `<br>` tag.\n\t\t\tclearTimeout( this.keyupTimeout )\n\t\t\tthis.keyupTimeout = setTimeout(this.endWithBrTag.bind(this), 300);\n\t\t\t\n\t\t},\n\t\t\n\t\tonKeypress: function(e){\n\t\t\tthis.markHistoryIn(500);\n\t\t},\n\t\t\n\t\tendWithBrTag: function () {\n\t\t\t\n\t\t\t// dont do this if auto complete showing, cause when calling `replaceWithToken`;\n\t\t\t// it would replace more than the word if 300ms passed before selecting\n\t\t\tif( this.subview('auto-complete').isShowing ) return;\n\t\t\t\n\t\t\tif( !this.el.innerHTML.match(/<br>$/) ){\n\t\t\t\t\n\t\t\t\tif( !this.isInFocus() )\n\t\t\t\t\tthis.focusEnd();\n\t\t\t\t\n\t\t\t\tvar sel = window.getSelection();\n\t\t\t\t\n\t\t\t\t// no selection after telling to focus? then the editor is not in the DOM\n\t\t\t\tif( sel.type == 'None'){\n\t\t\t\t\tthis.el.appendChild(document.createElement('br'))\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tvar range = sel.getRangeAt(0);\n\t\t\t\tvar frag = document.createDocumentFragment()\n\t\t\t\tvar br = frag.appendChild( document.createElement('br') );\n\t\t\t\t\n\t\t\t\t//document.execCommand('insertHTML', false, frag);\n\t\t\t\tthis.el.appendChild(frag)\n\t\t\t\t\n\t\t\t\t// this breaks in Safari....\n\t\t\t\trange = range.cloneRange();\n\t\t\t\trange.setStartBefore(br);\n\t\t\t\trange.collapse(true);\n\t\t\t\tsel.removeAllRanges();\n\t\t\t\tsel.addRange(range);\n\t\t\t}\n\t\t\t\n\t\t},\n\t\t\n\t\tinsertHTML: function(html){\n\t\t\t\n\t\t\tif( !this.isInFocus() )\n\t\t\t\tthis.focusEnd();\n\t\t\t\n\t\t\t// http://stackoverflow.com/a/6691294/484780\n\t\t\tsel = window.getSelection();\n\t\t\t\n\t        if (sel.getRangeAt && sel.rangeCount) {\n\t            range = sel.getRangeAt(0);\n\t            range.deleteContents();\n\n\t            var el = document.createElement(\"div\");\n\t            el.innerHTML = html;\n\t\t\t\t\n\t            var frag = document.createDocumentFragment(), node, lastNode;\n\t            \n\t\t\t\twhile ( (node = el.firstChild) ) {\n\t                lastNode = frag.appendChild(node);\n\t            }\n\t\t\t\t\n\t            range.insertNode(frag);\n\n\t            // Preserve the selection\n\t            if (lastNode) {\n\t                range = range.cloneRange();\n\t                range.setStartAfter(lastNode);\n\t                range.collapse(true);\n\t                sel.removeAllRanges();\n\t                sel.addRange(range);\n\t            }\n\t\t\t\t\n\t\t\t\tthis.markHistory();\n\t        }\n\t\t\n\t\t},\n\t\t\n\t\tlength: function(){\n\t\t\treturn this.el.innerText.trim().replace(/\\n/g, '').length\n\t\t},\n\t\t\n\t\tisInFocus: function(){\n\t\t\treturn document.activeElement == this.el\n\t\t},\n\t\t\n\t\t// focuses editor and sets caret position\n\t\tfocus: function(atChar){\n\t\t\tif( atChar === undefined || atChar < 0 || atChar > this.length() )\n\t\t\t\tatChar = 0;\n\t\t\t\n\t\t\tthis.setSelection(atChar, atChar);\n\t\t},\n\t\t\n\t\t// focuses editor at the end\n\t\tfocusEnd: function(){\n\t\t\tthis.focus(this.length())\n\t\t},\n\t\t\n\t\tselectAll: function(){ this.setSelection(0, this.length()) },\n\t\t\n\t\tjsonToHTML: function(json){\n\t\t\tvar self = this;\n\t\t\tvar lines = _.map(json, function(row){\n\t\t\t\treturn _.reduce(row, function(str, d){\n\t\t\t\t\tif( typeof d == 'string' )\n\t\t\t\t\t\treturn str + d\n\t\t\t\t\telse if( d.label !== undefined )\n\t\t\t\t\t\treturn str + self.makeToken(d)\n\t\t\t\t\t\t\n\t\t\t\t\t// legacy support\n\t\t\t\t\telse\n\t\t\t\t\t\treturn str + self._objectTextareaObjectToHTML(d)\n\t\t\t\t}, '')\n\t\t\t})\n\t\t\treturn lines.join('<br class=\"newline\">');\n\t\t},\n\t\t\n\t\t// legacy support\n\t\t_objectTextareaObjectToHTML: function(d){\n\t\t\tif( d.type == 'text' )\n\t\t\t\treturn d.data.text;\n\t\t\t\n\t\t\tvar attrs = _.clone(d.data);\n\t\t\tvar label = d.data.text; delete attrs.text;\n\t\t\t\n\t\t\treturn this.makeToken({label: label, attrs: attrs})\n\t\t},\n\t\t\n\t\ttoHTML: function(){\n\t\t\treturn this.el.innerHTML.replace(/<br>$/, '');\n\t\t},\n\t\t\n\t\ttoString: function(lineSeparator){\n\t\t\tlineSeparator = lineSeparator || \"\\n\";\n\t\t\tvar html = _.stripTags( this.toHTML().replace(/<br class=\"newline\">/g, \"||\") )\n\t\t\treturn html.replace(/\\|\\|/g, lineSeparator)\n\t\t},\n\t\t\n\t\t// creates a JSON structure of the editor content\n\t\ttoJSON: function(){\n\t\t\t\n\t\t\tvar html = this.toHTML();\n\t\t\t\n\t\t\tif( !html ) return [];\n\t\t\t\n\t\t\t// split each row by the `<br>` tag\n\t\t\tvar json = html.split('<br class=\"newline\">');\n\t\t\t\n\t\t\t// covert each row to array of strings and objects \n\t\t\tjson = _.map(json, function(str){\n\t\t\t\t\n\t\t\t\t// make a temp DOM element for navigating through child nodes\n\t\t\t\tvar div = document.createElement('div')\n\t\t\t\tdiv.innerHTML = str;\n\t\t\t\t\n\t\t\t\t// row data\n\t\t\t\tvar row = [];\n\t\t\t\t\n\t\t\t\t// make each node an object\n\t\t\t\t_.each(div.childNodes, function(node){\n\t\t\t\t\t\n\t\t\t\t\t// simple string of text\n\t\t\t\t\tif( !node.tagName )\n\t\t\t\t\t\trow.push(node.textContent)\n\t\t\t\t\t\n\t\t\t\t\t// spans are 'tokens', so make them an {}\n\t\t\t\t\telse if( node.tagName == 'SPAN'){\n\t\t\t\t\t\trow.push({\n\t\t\t\t\t\t\tlabel: node.textContent,\n\t\t\t\t\t\t\tattrs: _.clone(node.dataset)\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t})\n\t\t\t\t\n\t\t\t\treturn row;\n\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t\treturn json;\n\t\t},\n\t\t\n\t\t// Legacy support until code that relies on old objectTextarea format is updated\n\t\ttoObjectTextarea: function(){\n\t\t\tvar json = this.toJSON();\n\t\t\t\n\t\t\treturn _.map(json, function(row){ return _.map(row, function(d){\n\t\t\t\n\t\t\t\tif( typeof d == 'string' ){\n\t\t\t\t\treturn {type: \"text\", data: {text: d}}\n\t\t\t\t}else{\n\t\t\t\t\tvar attrs = d.attrs;\n\t\t\t\t\tattrs.text = d.label;\n\t\t\t\t\treturn {type: \"bubble\", data: attrs}\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})})\n\t\t},\n\t\t\n\t\tsetSelection: function(start, end) {\n\t\t\t\n\t\t\tvar range = document.createRange(),\n\t\t\t\tcount = 0, startNode, endNode;\n\t\t\t\n\t\t\t_.each(this.el.childNodes, function(node, indx){\n\t\t\t\t\n\t\t\t\tvar len = (node.innerText ? node.innerText.length : node.length) || 0;\n\t\t\t\t\n\t\t\t\tcount = count + len;\n\t\t\t\t\n\t\t\t\t//console.log(count, len);\n\t\t\t\t\n\t\t\t\t// found start of selection\n\t\t\t\tif( (count > start || (count == start && len == 0)) && !startNode ){\n\t\t\t\t\t\n\t\t\t\t\tstartNode = node;\n\t\t\t\t\trange.setStart(node, node.tagName ? 0 : start - (count - len)  )\n\t\t\t\t\t\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif( (count > end || (count == end && len == 0)) && !endNode ){\n\t\t\t\t\t\n\t\t\t\t\tendNode = node;\n\t\t\t\t\t\n\t\t\t\t\tif( node.tagName && len > 0 )\n\t\t\t\t\t\tif( node.nextSibling )\n\t\t\t\t\t\t\trange.setEnd(node.nextSibling, 0)\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\trange.setEnd(node, 0)\n\t\t\t\t\telse\n\t\t\t\t\t\trange.setEnd(node, end - (count - len) )\n\t\t\t\t}\n\t\t\t\t\n\t\t\t})\n\t\t\t\n\t\t\tthis.el.focus();\n\t\t\t\n\t\t\tvar sel = window.getSelection();\n\t\t\tsel.removeAllRanges();\n\t\t\tsel.addRange(range);\n\t\t\t\n\t\t\treturn;\n\t\t\t\n\t\t\t// http://stackoverflow.com/a/16100733/484780\n\t    },\n\t\t\n\t\tgetSelection: function() {\n\t\t\t\n\t\t\tvar sel = window.getSelection();\n\t\t\t\n\t\t\tif( sel.type == 'None' )\n\t\t\t\treturn {\n\t\t\t\t\tstart: this.length(),\n\t\t\t\t\tend: this.length()\n\t\t\t\t}\n\t\t\t\t\n\t        var range = sel.getRangeAt(0);\n\t        \n\t\t\tvar preSelectionRange = range.cloneRange();\n\t        preSelectionRange.selectNodeContents(this.el);\n\t        preSelectionRange.setEnd(range.startContainer, range.startOffset);\n\t        var start = preSelectionRange.toString().length;\n\n\t        return {\n\t            start: start,\n\t            end: start + range.toString().length\n\t        };\n\t    },\n\t\t\n\t\tmetaKey: function(e){\n\t\t\te = e || event;\n\t\t\treturn e && (e.ctrlKey || e.altKey || e.metaKey);\n\t\t},\n\t\t\n\t\tmarkHistory: function(){\n\t\t\t// splices history at current history index (and removes all history after current index)\n\t\t\tthis.history.splice(this.historyAt+1, Number.MAX_VALUE, {\n\t\t\t\tcaret: this.getSelection(),\n\t\t\t\tcontent: this.el.innerHTML\n\t\t\t})\n\t\t\t\n\t\t\tthis.historyAt = this.history.length - 1;\n\t\t},\n\t\t\n\t\tmarkHistoryIn: function(ms){\n\t\t\tclearTimeout( this.historyTimeout )\n\t\t\tthis.historyTimeout = setTimeout(this.markHistory.bind(this), ms||0);\n\t\t},\n\t\t\n\t\tundo: function(){\n\t\t\tif( this.historyAt <= 0 ) return;\n\t\t\tthis.applyHistory(this.history[ --this.historyAt ])\n\t\t},\n\t\t\n\t\tredo: function(){\n\t\t\tif( this.historyAt >= this.history.length - 1 ) return;\n\t\t\tthis.applyHistory(this.history[ ++this.historyAt ])\n\t\t},\n\t\t\n\t\tapplyHistory: function(hist){\n\t\t\tthis.el.innerHTML = hist.content;\n\t\t\tthis.setSelection(hist.caret.start, hist.caret.end)\n\t\t},\n\t\t\n\t})\n\t\n});\n"
  ]
}